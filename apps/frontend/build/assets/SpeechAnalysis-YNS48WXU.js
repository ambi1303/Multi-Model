import{p as e,q as t,r as s,s as r,t as i,v as a,j as n,w as o,x as l,y as c,z as d,D as p,G as u,J as x,K as h,O as m,T as g,k as y,i as b,l as j,Q as f,f as v,E as w,B as C,W as k,I as S,X as R,Y as W,$ as A,a0 as I,a1 as D,a as $,b as T,C as E,a2 as B,a3 as M,M as P,a4 as z,o as F,c as N,P as L,a5 as U,a6 as O,a7 as Y,a8 as G,a9 as H,aa as K,ab as _,n as X,ac as J,m as q,ad as Q}from"./index-Cu1Lb5wm.js";import{u as V,E as Z,G as ee,a as te,S as se,b as re,c as ie,g as ae}from"./useAnalysisProgress-b6HtDM4F.js";import{B as ne}from"./Badge-D-Xm5ptJ.js";import{T as oe}from"./TextField-nZ9cWrjP.js";import{u as le}from"./useControlled-DBWomjFB.js";import{a as ce,S as de}from"./Slider-CA2t5g-6.js";import{T as pe,a as ue}from"./Tabs-CKCUqr9g.js";import{G as xe}from"./Grid-DWJmqObS.js";import{C as he}from"./CardContent-CM-AlMCa.js";import{L as me}from"./LinearProgress-H4j6QmzZ.js";import{T as ge}from"./Tooltip-B6ktqcHM.js";import{L as ye}from"./ListItemAvatar-Bk1iDEBg.js";import{C as be}from"./Collapse-DOWn6ttS.js";import"./Zoom-nMLUDPl8.js";import"./Card-DfkK2QiN.js";import"./FormControl-6_QTQo-v.js";function je(t){return e("MuiCardActions",t)}t("MuiCardActions",["root","spacing"]);const fe=["disableSpacing","className"],ve=o("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.disableSpacing&&t.spacing]}})(({ownerState:e})=>a({display:"flex",alignItems:"center",padding:8},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),we=s.forwardRef(function(e,t){const s=r({props:e,name:"MuiCardActions"}),{disableSpacing:o=!1,className:d}=s,p=i(s,fe),u=a({},s,{disableSpacing:o}),x=(e=>{const{classes:t,disableSpacing:s}=e;return c({root:["root",!s&&"spacing"]},je,t)})(u);return n.jsx(ve,a({className:l(x.root,d),ownerState:u,ref:t},p))});function Ce(t){return e("MuiDialog",t)}const ke=t("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),Se=s.createContext({}),Re=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],We=o(m,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),Ae=o(h,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),Ie=o("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.container,t[`scroll${x(s.scroll)}`]]}})(({ownerState:e})=>a({height:"100%","@media print":{height:"auto"},outline:0},"paper"===e.scroll&&{display:"flex",justifyContent:"center",alignItems:"center"},"body"===e.scroll&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),De=o(p,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.paper,t[`scrollPaper${x(s.scroll)}`],t[`paperWidth${x(String(s.maxWidth))}`],s.fullWidth&&t.paperFullWidth,s.fullScreen&&t.paperFullScreen]}})(({theme:e,ownerState:t})=>a({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},"paper"===t.scroll&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},"body"===t.scroll&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!t.maxWidth&&{maxWidth:"calc(100% - 64px)"},"xs"===t.maxWidth&&{maxWidth:"px"===e.breakpoints.unit?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${ke.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}},t.maxWidth&&"xs"!==t.maxWidth&&{maxWidth:`${e.breakpoints.values[t.maxWidth]}${e.breakpoints.unit}`,[`&.${ke.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[t.maxWidth]+64)]:{maxWidth:"calc(100% - 64px)"}}},t.fullWidth&&{width:"calc(100% - 64px)"},t.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${ke.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),$e=s.forwardRef(function(e,t){const o=r({props:e,name:"MuiDialog"}),h=d(),m={enter:h.transitions.duration.enteringScreen,exit:h.transitions.duration.leavingScreen},{"aria-describedby":g,"aria-labelledby":y,BackdropComponent:b,BackdropProps:j,children:f,className:v,disableEscapeKeyDown:w=!1,fullScreen:C=!1,fullWidth:k=!1,maxWidth:S="sm",onBackdropClick:R,onClick:W,onClose:A,open:I,PaperComponent:D=p,PaperProps:$={},scroll:T="paper",TransitionComponent:E=u,transitionDuration:B=m,TransitionProps:M}=o,P=i(o,Re),z=a({},o,{disableEscapeKeyDown:w,fullScreen:C,fullWidth:k,maxWidth:S,scroll:T}),F=(e=>{const{classes:t,scroll:s,maxWidth:r,fullWidth:i,fullScreen:a}=e,n={root:["root"],container:["container",`scroll${x(s)}`],paper:["paper",`paperScroll${x(s)}`,`paperWidth${x(String(r))}`,i&&"paperFullWidth",a&&"paperFullScreen"]};return c(n,Ce,t)})(z),N=s.useRef(),L=le(y),U=s.useMemo(()=>({titleId:L}),[L]);return n.jsx(Ae,a({className:l(F.root,v),closeAfterTransition:!0,components:{Backdrop:We},componentsProps:{backdrop:a({transitionDuration:B,as:b},j)},disableEscapeKeyDown:w,onClose:A,open:I,ref:t,onClick:e=>{W&&W(e),N.current&&(N.current=null,R&&R(e),A&&A(e,"backdropClick"))},ownerState:z},P,{children:n.jsx(E,a({appear:!0,in:I,timeout:B,role:"presentation"},M,{children:n.jsx(Ie,{className:l(F.container),onMouseDown:e=>{N.current=e.target===e.currentTarget},ownerState:z,children:n.jsx(De,a({as:D,elevation:24,role:"dialog","aria-describedby":g,"aria-labelledby":L},$,{className:l(F.paper,$.className),ownerState:z,children:n.jsx(Se.Provider,{value:U,children:f})}))})}))}))});function Te(t){return e("MuiDialogActions",t)}t("MuiDialogActions",["root","spacing"]);const Ee=["className","disableSpacing"],Be=o("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.disableSpacing&&t.spacing]}})(({ownerState:e})=>a({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Me=s.forwardRef(function(e,t){const s=r({props:e,name:"MuiDialogActions"}),{className:o,disableSpacing:d=!1}=s,p=i(s,Ee),u=a({},s,{disableSpacing:d}),x=(e=>{const{classes:t,disableSpacing:s}=e;return c({root:["root",!s&&"spacing"]},Te,t)})(u);return n.jsx(Be,a({className:l(x.root,o),ownerState:u,ref:t},p))});function Pe(t){return e("MuiDialogContent",t)}function ze(t){return e("MuiDialogTitle",t)}t("MuiDialogContent",["root","dividers"]);const Fe=t("MuiDialogTitle",["root"]),Ne=["className","dividers"],Le=o("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.dividers&&t.dividers]}})(({theme:e,ownerState:t})=>a({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},t.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${Fe.root} + &`]:{paddingTop:0}})),Ue=s.forwardRef(function(e,t){const s=r({props:e,name:"MuiDialogContent"}),{className:o,dividers:d=!1}=s,p=i(s,Ne),u=a({},s,{dividers:d}),x=(e=>{const{classes:t,dividers:s}=e;return c({root:["root",s&&"dividers"]},Pe,t)})(u);return n.jsx(Le,a({className:l(x.root,o),ownerState:u,ref:t},p))}),Oe=["className","id"],Ye=o(g,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),Ge=s.forwardRef(function(e,t){const o=r({props:e,name:"MuiDialogTitle"}),{className:d,id:p}=o,u=i(o,Oe),x=o,h=(e=>{const{classes:t}=e;return c({root:["root"]},ze,t)})(x),{titleId:m=p}=s.useContext(Se);return n.jsx(Ye,a({component:"h2",className:l(h.root,d),ownerState:x,ref:t,variant:"h6",id:null!=p?p:m},u))}),He=async e=>{const t=new FormData;t.append("audio_file",e,"audio.webm");const s=(await y.post("/analyze-speech",t,{headers:{"Content-Type":"multipart/form-data"}})).data;return{transcription:s.transcription,sentiment:s.sentiment,emotions:s.emotions,genAIInsights:s.genAIInsights,technicalReport:s.technicalReport,duration:0,timestamp:Date.now()}},Ke=async()=>(await y.get("/emo-buddy/availability")).data,_e=async e=>(await y.post("/emo-buddy/start",{analysis_report:e})).data,Xe=async(e,t)=>(await y.post("/emo-buddy/continue",{session_id:e,user_input:t})).data,Je=async e=>(await y.post("/emo-buddy/end",{session_id:e})).data,qe=o(p)(({theme:e})=>({position:"fixed",bottom:20,right:20,padding:e.spacing(2),borderRadius:20,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,color:e.palette.primary.contrastText,boxShadow:e.shadows[8],cursor:"pointer",transition:"all 0.3s ease",zIndex:1400,maxWidth:300,"&:hover":{transform:"translateY(-2px)",boxShadow:e.shadows[12]}})),Qe=o(p)(({theme:e})=>({position:"fixed",bottom:100,right:20,width:380,height:500,display:"flex",flexDirection:"column",borderRadius:16,overflow:"hidden",boxShadow:e.shadows[16],zIndex:1300,background:e.palette.background.paper})),Ve=o(C)(({theme:e})=>({background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,color:e.palette.primary.contrastText,padding:e.spacing(2),display:"flex",alignItems:"center",justifyContent:"space-between"})),Ze=o(C)(({theme:e})=>({flex:1,padding:e.spacing(1),overflowY:"auto",display:"flex",flexDirection:"column",gap:e.spacing(1),background:ce(e.palette.background.default,.5)})),et=o(C)(({theme:e,isUser:t})=>({maxWidth:"80%",padding:e.spacing(1,2),borderRadius:16,background:t?e.palette.primary.main:e.palette.action.hover,color:t?e.palette.primary.contrastText:e.palette.text.primary,alignSelf:t?"flex-end":"flex-start",wordWrap:"break-word",animation:"slideIn 0.3s ease","@keyframes slideIn":{from:{opacity:0,transform:"translateY(10px)"},to:{opacity:1,transform:"translateY(0)"}}})),tt=o(C)(({theme:e})=>({padding:e.spacing(2),borderTop:`1px solid ${e.palette.divider}`,display:"flex",alignItems:"center",gap:e.spacing(1)})),st=({analysisResult:e,onClose:t})=>{d();const{showError:r,showSuccess:i}=j(),[a,o]=s.useState(!0),[l,c]=s.useState(!1),[p,x]=s.useState([]),[h,m]=s.useState(""),[y,b]=s.useState(!1),[T,E]=s.useState(null),[B,M]=s.useState(!1),[P,z]=s.useState(!1),F=s.useRef(null),N=s.useRef(null),L=s.useRef(0),U=s.useRef(0);s.useEffect(()=>{var e;null==(e=F.current)||e.scrollIntoView({behavior:"smooth"})},[p]),s.useEffect(()=>{l&&!B&&setTimeout(()=>{var e;return null==(e=N.current)?void 0:e.focus()},100)},[l,B]);const O=async()=>{const e=Date.now();if(e-L.current<2e3)return;if(L.current=e,!h.trim()||!T||y)return;const t={id:Date.now().toString(),content:h.trim(),isUser:!0,timestamp:new Date};x(e=>[...e,t]),m(""),b(!0);try{const e=await Xe(T.session_id,t.content),s={id:(Date.now()+1).toString(),content:e.response,isUser:!1,timestamp:new Date};x(e=>[...e,s]),e.should_continue||setTimeout(()=>{z(!0)},2e3)}catch(s){console.error("Failed to send message:",s),r("Failed to send message. Please try again.")}finally{b(!1)}};return n.jsxs(n.Fragment,{children:[n.jsx(u,{in:a,children:n.jsx(qe,{onClick:async()=>{if(e){o(!1),b(!0);try{if(!(await Ke()).available)return void r("Emo Buddy is currently unavailable. Please try again later.");const t=await _e(e);E(t);const s={id:Date.now().toString(),content:t.response,isUser:!1,timestamp:new Date};x([s]),c(!0),i("Emo Buddy session started! ðŸ¤–")}catch(t){console.error("Failed to start Emo Buddy session:",t),r("Failed to start Emo Buddy session. Please try again.")}finally{b(!1)}}else r("No analysis result available for Emo Buddy session.")},children:n.jsxs(f,{direction:"row",alignItems:"center",spacing:2,children:[n.jsx(ne,{badgeContent:"!",color:"error",children:n.jsx(v,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)"},children:n.jsx(w,{})})}),n.jsxs(C,{children:[n.jsx(g,{variant:"subtitle2",fontWeight:"bold",children:"Emo Buddy wants to talk! ðŸ¤–"}),n.jsx(g,{variant:"caption",sx:{opacity:.9},children:"I can help with your emotional wellbeing"})]})]})})}),n.jsx(k,{direction:"up",in:l,children:n.jsxs(Qe,{children:[n.jsxs(Ve,{children:[n.jsxs(f,{direction:"row",alignItems:"center",spacing:2,children:[n.jsx(v,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)"},children:n.jsx(w,{})}),n.jsxs(C,{children:[n.jsx(g,{variant:"h6",children:"Emo Buddy"}),n.jsx(g,{variant:"caption",sx:{opacity:.8},children:"Your therapeutic companion"})]})]}),n.jsxs(f,{direction:"row",spacing:1,children:[n.jsx(S,{size:"small",onClick:()=>M(!B),sx:{color:"inherit"},children:B?n.jsx(R,{}):n.jsx(W,{})}),n.jsx(S,{size:"small",onClick:()=>z(!0),sx:{color:"inherit"},children:n.jsx(A,{})})]})]}),!B&&n.jsxs(n.Fragment,{children:[n.jsxs(Ze,{children:[p.map(e=>n.jsx(et,{isUser:e.isUser,children:n.jsx(g,{variant:"body2",children:e.content})},e.id)),y&&n.jsx(et,{isUser:!1,children:n.jsxs(f,{direction:"row",alignItems:"center",spacing:1,children:[n.jsx(I,{size:16}),n.jsx(g,{variant:"body2",children:"Emo Buddy is typing..."})]})}),n.jsx("div",{ref:F})]}),n.jsxs(tt,{children:[n.jsx(oe,{ref:N,fullWidth:!0,placeholder:"Type your message...",value:h,onChange:e=>m(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),O())},disabled:y,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:20}}}),n.jsx(S,{onClick:O,disabled:!h.trim()||y,color:"primary",children:n.jsx(D,{})})]})]})]})}),n.jsxs($e,{open:P,onClose:()=>z(!1),children:[n.jsx(Ge,{children:"End Emo Buddy Session?"}),n.jsx(Ue,{children:n.jsx(g,{children:"Are you sure you want to end your therapeutic session with Emo Buddy? Your conversation will be summarized and saved for your records."})}),n.jsxs(Me,{children:[n.jsx($,{onClick:()=>z(!1),children:"Continue Chat"}),n.jsx($,{onClick:async()=>{const e=Date.now();if(!(e-U.current<2e3)&&(U.current=e,T))try{await Je(T.session_id),i("Emo Buddy session ended. Take care! ðŸ’™"),c(!1),z(!1),t()}catch(s){console.error("Failed to end session:",s),r("Failed to end session properly.")}},variant:"contained",color:"primary",children:"End Session"})]})]})]})},rt=o(C)(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",gap:e.spacing(.5),height:60,padding:e.spacing(1),borderRadius:e.shape.borderRadius,background:`linear-gradient(135deg, ${e.palette.primary.light}20, ${e.palette.secondary.light}20)`,border:`1px solid ${e.palette.divider}`})),it=o(C)(({theme:e,isActive:t,height:s})=>({width:4,height:`${s}px`,backgroundColor:t?e.palette.primary.main:e.palette.grey[400],borderRadius:2,transition:"all 0.3s ease",animation:t?"wave 1.5s ease-in-out infinite":"none","@keyframes wave":{"0%, 100%":{transform:"scaleY(1)"},"50%":{transform:"scaleY(1.5)"}}})),at=o($)(({theme:e,isRecording:t})=>({width:120,height:120,borderRadius:"50%",fontSize:"2.5rem",transition:"all 0.3s ease",background:t?`linear-gradient(135deg, ${e.palette.error.main}, ${e.palette.error.dark})`:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.primary.dark})`,boxShadow:t?e.shadows[8]:e.shadows[4],animation:t?"pulse 2s infinite":"none","&:hover":{transform:"scale(1.05)",boxShadow:e.shadows[12]},"@keyframes pulse":{"0%":{transform:"scale(1)",opacity:1},"50%":{transform:"scale(1.1)",opacity:.8},"100%":{transform:"scale(1)",opacity:1}}})),nt=()=>{const e=d(),[t,r]=s.useState("record"),[i,a]=s.useState(null),[o,l]=s.useState(!1),[c,x]=s.useState(!1),[h,m]=s.useState(!1),[y,b]=s.useState(null),k=s.useRef(null),{isRecording:R,audioBlob:W,duration:A,error:I,start:D,stop:oe,reset:le}=(()=>{const[e,t]=s.useState(!1),[r,i]=s.useState(null),[a,n]=s.useState(0),[o,l]=s.useState(null),c=s.useRef(null),d=s.useRef(null),p=s.useRef(null),u=s.useRef([]),x=s.useCallback(async()=>{try{l(null),i(null),n(0),u.current=[];const e=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}});d.current=e;const s=new MediaRecorder(e,{mimeType:MediaRecorder.isTypeSupported("audio/webm")?"audio/webm":"audio/mp4"});c.current=s,s.ondataavailable=e=>{e.data.size>0&&u.current.push(e.data)},s.onstop=()=>{const e=new Blob(u.current,{type:s.mimeType||"audio/webm"});i(e),d.current&&(d.current.getTracks().forEach(e=>e.stop()),d.current=null)},s.start(100),t(!0),p.current=setInterval(()=>{n(e=>e+1)},1e3)}catch(e){const t=e;let s="Failed to access microphone";"NotAllowedError"===t.name?s="Microphone access denied. Please allow microphone permissions.":"NotFoundError"===t.name&&(s="No microphone found. Please connect a microphone and try again."),l(s)}},[]),h=s.useCallback(()=>{c.current&&e&&(c.current.stop(),t(!1),p.current&&(clearInterval(p.current),p.current=null))},[e]),m=s.useCallback(()=>{h(),i(null),n(0),l(null),u.current=[]},[h]);return s.useEffect(()=>()=>{p.current&&clearInterval(p.current),d.current&&d.current.getTracks().forEach(e=>e.stop())},[]),{isRecording:e,audioBlob:r,duration:a,error:o,start:x,stop:h,reset:m}})(),{progress:ce,isLoading:je,startProgress:fe,completeProgress:ve}=V(),{settings:Ce,updateSetting:ke}=(()=>{const[e,t]=s.useState({quality:"high",noiseReduction:!0,echoCancellation:!0,autoGain:!0,sensitivity:50});return{settings:e,updateSetting:s.useCallback((e,s)=>{t(t=>({...t,[e]:s}))},[])}})(),{history:Se,addAnalysis:Re,clearHistory:We}=(()=>{const[e,t]=s.useState([]);return{history:e,addAnalysis:s.useCallback(e=>{t(t=>[...t.slice(-4),e])},[]),clearHistory:s.useCallback(()=>{t([])},[])}})(),{showSuccess:Ae,showError:Ie}=j(),{addAnalysisResult:De}=T(),Te=s.useCallback(e=>`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`,[]),Ee=s.useCallback(()=>{if(W)if(c&&k.current)k.current.pause(),x(!1);else{k.current&&k.current.pause();const e=new Audio(URL.createObjectURL(W));k.current=e,e.onended=()=>x(!1),e.onerror=()=>{Ie("Failed to play audio."),x(!1)},e.play().then(()=>x(!0)).catch(()=>{Ie("Failed to play audio."),x(!1)})}},[W,c,Ie]),Be=s.useCallback(()=>{if(!W)return;const e=URL.createObjectURL(W),t=`speech-analysis-${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.webm`,s=document.createElement("a");s.href=e,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(e),Ae(`Audio saved as ${t} ðŸ“`)},[W,Ae]),Me=s.useCallback(()=>{le(),a(null),k.current&&k.current.pause(),x(!1)},[le]),Pe=()=>{i?(b(i),m(!0)):Ie("No analysis result available for EmoBuddy.")},ze=()=>{const e=Array.from({length:20},(e,t)=>n.jsx(it,{isActive:R,height:40*Math.random()+10,sx:{animationDelay:.1*t+"s"}},t));return n.jsx(rt,{children:e})};return n.jsxs(C,{sx:{maxWidth:1200,mx:"auto",p:3},children:[n.jsxs(C,{sx:{textAlign:"center",mb:4,opacity:0,animation:"slideInDown 0.8s ease-out forwards","@keyframes slideInDown":{"0%":{opacity:0,transform:"translateY(-30px)"},"100%":{opacity:1,transform:"translateY(0)"}}},children:[n.jsx(g,{variant:"h3",component:"h1",sx:{fontWeight:700,mb:2,background:`linear-gradient(45deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"ðŸŽ¤ Smart Speech Analysis"}),n.jsx(g,{variant:"h6",color:"text.secondary",sx:{mb:3},children:"Record and analyze emotions from speech patterns and vocal characteristics"}),n.jsxs(f,{direction:"row",spacing:2,justifyContent:"center",sx:{mb:3},children:[n.jsx(E,{icon:n.jsx(B,{}),label:`${Se.length} Analyses`,color:"primary",variant:"outlined"}),n.jsx(E,{icon:n.jsx(w,{}),label:"Real-time AI",color:"secondary",variant:"outlined"}),n.jsx(E,{icon:n.jsx(M,{}),label:"Enhanced UX",color:"success",variant:"outlined"})]})]}),n.jsx(p,{sx:{mb:3},children:n.jsxs(pe,{value:t,onChange:(e,t)=>{r(t)},variant:"fullWidth",children:[n.jsx(ue,{label:"Record & Analyze",value:"record",icon:n.jsx(P,{}),iconPosition:"start"}),n.jsx(ue,{label:"Analysis History",value:"history",icon:n.jsx(z,{}),iconPosition:"start"})]})}),"record"===t&&n.jsxs(xe,{container:!0,spacing:4,children:[n.jsx(xe,{item:!0,xs:12,md:6,children:n.jsxs(Z,{sx:{mb:4},children:[n.jsxs(he,{children:[n.jsx(g,{variant:"h5",sx:{fontWeight:600,mb:4},children:"ðŸŽ™ï¸ Audio Recording"}),n.jsx(C,{sx:{mb:4},children:n.jsx(at,{isRecording:R,onClick:R?oe:D,variant:"contained",disabled:je,children:R?n.jsx(q,{}):n.jsx(P,{})})}),n.jsx(g,{variant:"h3",sx:{fontFamily:"monospace",fontWeight:700,mb:2,color:R?"error.main":"text.primary"},children:Te(A)}),R&&n.jsxs(C,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:1,mb:3},children:[n.jsx(C,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:"error.main",animation:"blink 1s infinite","@keyframes blink":{"0%, 50%":{opacity:1},"51%, 100%":{opacity:0}}}}),n.jsx(g,{variant:"body2",color:"error.main",sx:{fontWeight:500},children:"Recording in progress..."})]}),ze(),n.jsxs(f,{spacing:2,sx:{mt:3},children:[n.jsx($,{variant:"outlined",startIcon:n.jsx(X,{}),onClick:Me,fullWidth:!0,disabled:R||je,children:"Reset Recording"}),n.jsx($,{variant:"outlined",startIcon:n.jsx(Q,{}),onClick:()=>l(!o),fullWidth:!0,children:"Audio Settings"})]}),n.jsx(be,{in:o,children:n.jsxs(Z,{interactive:!1,sx:{mt:2,p:2,bgcolor:"background.default"},children:[n.jsx(g,{variant:"subtitle2",sx:{mb:2,fontWeight:"bold"},children:"ðŸ”§ Recording Settings"}),n.jsxs(f,{spacing:2,children:[n.jsxs(C,{children:[n.jsx(g,{variant:"body2",sx:{mb:1},children:"Microphone Sensitivity"}),n.jsx(de,{value:Ce.sensitivity,onChange:(e,t)=>ke("sensitivity",t),min:0,max:100,step:10,marks:!0,valueLabelDisplay:"auto"})]}),n.jsxs(f,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:[n.jsx(E,{label:"Noise Reduction",color:Ce.noiseReduction?"primary":"default",onClick:()=>ke("noiseReduction",!Ce.noiseReduction),clickable:!0}),n.jsx(E,{label:"Echo Cancellation",color:Ce.echoCancellation?"primary":"default",onClick:()=>ke("echoCancellation",!Ce.echoCancellation),clickable:!0}),n.jsx(E,{label:"Auto Gain",color:Ce.autoGain?"primary":"default",onClick:()=>ke("autoGain",!Ce.autoGain),clickable:!0})]})]})]})}),I&&n.jsx(F,{severity:"error",sx:{mt:2},children:I})]}),n.jsxs(we,{sx:{justifyContent:"space-between",p:2,flexWrap:"wrap",gap:2},children:[n.jsx($,{startIcon:n.jsx(X,{}),onClick:Me,color:"secondary",children:"Analyze New Audio"}),n.jsx(ee,{startIcon:n.jsx(w,{}),onClick:Pe,children:"Ask EmoBuddy"})]})]})}),n.jsx(xe,{item:!0,xs:12,md:6,children:n.jsx(Z,{children:n.jsxs(he,{sx:{p:4},children:[n.jsx(g,{variant:"h5",sx:{fontWeight:600,mb:3},children:"ðŸŽµ Audio Analysis"}),W?n.jsxs(C,{children:[n.jsxs(F,{severity:"success",sx:{mb:3},children:[n.jsx(g,{variant:"subtitle2",sx:{fontWeight:600},children:"Recording Ready for Analysis"}),n.jsxs(g,{variant:"body2",children:["Duration: ",Te(A)," â€¢ Size: ",(W.size/1024).toFixed(1)," KB"]})]}),ce>0&&n.jsx(u,{in:!0,children:n.jsxs(C,{sx:{mb:3},children:[n.jsx(me,{variant:"determinate",value:ce,sx:{height:8,borderRadius:4,"& .MuiLinearProgress-bar":{borderRadius:4,background:`linear-gradient(45deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`}}}),n.jsxs(g,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:["Analyzing audio... ",ce.toFixed(0),"%"]})]})}),n.jsxs(xe,{container:!0,spacing:2,sx:{mb:3},children:[n.jsx(xe,{item:!0,xs:4,children:n.jsx(ge,{title:c?"Pause Audio":"Play Audio",children:n.jsx($,{variant:"outlined",startIcon:c?n.jsx(N,{}):n.jsx(L,{}),onClick:Ee,fullWidth:!0,size:"small",children:c?"Pause":"Play"})})}),n.jsx(xe,{item:!0,xs:4,children:n.jsx(ge,{title:"Download Audio",children:n.jsx($,{variant:"outlined",startIcon:n.jsx(U,{}),onClick:Be,fullWidth:!0,size:"small",children:"Save"})})}),n.jsx(xe,{item:!0,xs:4,children:n.jsx(ee,{onClick:async()=>{if(!W)return void Ie("No audio recording available.");const e=fe();try{const e={...await He(W),duration:A,timestamp:Date.now()};a(e),Re(e),De("speech",e),Ae("Audio analyzed successfully! ðŸŽ‰"),b(e),setTimeout(()=>{m(!0)},2e3)}catch(t){Ie("Failed to analyze audio. Please try again.")}finally{ve(e)}},loading:je,loadingText:"Analyzing...",size:"small",fullWidth:!0,children:"Analyze"})})]})]}):n.jsxs(C,{sx:{p:4,textAlign:"center",backgroundColor:"dark"===e.palette.mode?"grey.900":"grey.50",borderRadius:2,border:"2px dashed",borderColor:"divider"},children:[n.jsx(C,{sx:{fontSize:48,color:"text.secondary",mb:2},children:n.jsx(O,{})}),n.jsx(g,{variant:"h6",color:"text.secondary",children:"No recording available"}),n.jsx(g,{variant:"body2",color:"text.secondary",children:"Start recording to analyze speech"})]})]})})})]}),"history"===t&&n.jsx(Z,{children:n.jsxs(he,{children:[n.jsxs(C,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[n.jsx(g,{variant:"h5",sx:{fontWeight:600},children:"ðŸ“š Analysis History"}),n.jsx($,{variant:"outlined",startIcon:n.jsx(Y,{}),onClick:We,disabled:0===Se.length,color:"error",children:"Clear All"})]}),Se.length>0?n.jsx(G,{sx:{width:"100%"},children:Se.reverse().map((e,t)=>{var s;return n.jsxs(H,{sx:{mb:2,border:"1px solid",borderColor:"divider",borderRadius:2,bgcolor:"background.paper"},children:[n.jsx(ye,{children:n.jsx(v,{sx:{bgcolor:"primary.main"},children:n.jsx(K,{})})}),n.jsx(_,{primary:n.jsxs(g,{variant:"subtitle1",sx:{fontWeight:600},children:["Analysis #",Se.length-t]}),secondary:n.jsxs(C,{children:[n.jsx(g,{variant:"body2",color:"text.secondary",children:new Date(e.timestamp).toLocaleString()}),n.jsxs(g,{variant:"body2",color:"text.secondary",children:["Duration: ",Te(e.duration)," â€¢ Sentiment: ",(null==(s=e.sentiment)?void 0:s.label)||"N/A"]}),e.emotions&&e.emotions.length>0&&n.jsx(C,{sx:{mt:1},children:n.jsx(te,{emotion:e.emotions[0].emotion})})]})})]},t)})}):n.jsxs(C,{sx:{textAlign:"center",py:4},children:[n.jsx(g,{variant:"h6",color:"text.secondary",children:"No analysis history yet"}),n.jsx(g,{variant:"body2",color:"text.secondary",children:"Start recording and analyzing speech to see your history here"})]})]})}),i&&!je&&"record"===t&&n.jsx(u,{in:!0,timeout:800,children:n.jsxs(C,{sx:{mt:4},children:[i.transcription&&n.jsxs(Z,{sx:{mb:3},children:[n.jsxs(he,{children:[n.jsxs(g,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:["ðŸ“ Transcription",n.jsx(E,{label:"AI Generated",size:"small",color:"primary"})]}),n.jsxs(g,{variant:"body1",sx:{p:2,backgroundColor:"dark"===e.palette.mode?"grey.900":"grey.50",borderRadius:2,fontStyle:"italic",lineHeight:1.6},children:['"',i.transcription,'"']})]}),n.jsx(we,{sx:{p:2,justifyContent:"flex-end"},children:n.jsx(ee,{startIcon:n.jsx(w,{}),onClick:Pe,children:"Ask EmoBuddy"})})]}),i.emotions&&(e=>{if(!e||0===e.length)return null;const t=e.sort((e,t)=>t.confidence-e.confidence).slice(0,5);return n.jsx(Z,{sx:{mb:3},children:n.jsxs(he,{children:[n.jsxs(g,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:["ðŸ˜Š Emotion Analysis",n.jsx(ne,{badgeContent:e.length,color:"primary"})]}),n.jsx(f,{spacing:2,children:t.map((e,t)=>n.jsxs(C,{sx:{display:"flex",alignItems:"center",gap:2},children:[n.jsx(te,{emotion:e.emotion}),n.jsx(C,{sx:{flexGrow:1},children:n.jsx(me,{variant:"determinate",value:100*e.confidence,sx:{height:8,borderRadius:4,"& .MuiLinearProgress-bar":{borderRadius:4,background:ae(e.emotion).color}}})}),n.jsxs(g,{variant:"body2",sx:{minWidth:50,textAlign:"right"},children:[(100*e.confidence).toFixed(1),"%"]})]},t))})]})})})(i.emotions),i.sentiment&&(e=>{if(!e)return null;const t="positive"===e.label?"success":"negative"===e.label?"error":"warning";return n.jsx(Z,{sx:{mb:3},children:n.jsxs(he,{children:[n.jsx(g,{variant:"h6",sx:{mb:2},children:"ðŸ’­ Sentiment Analysis"}),n.jsxs(C,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[n.jsx(E,{label:e.label.toUpperCase(),color:t,sx:{fontWeight:"bold"}}),n.jsxs(g,{variant:"body1",children:["Confidence: ",(100*e.confidence).toFixed(1),"%"]})]}),e.scores&&n.jsx(f,{spacing:1,children:Object.entries(e.scores).map(([e,t])=>n.jsxs(C,{sx:{display:"flex",alignItems:"center",gap:2},children:[n.jsxs(g,{variant:"body2",sx:{minWidth:80,textTransform:"capitalize"},children:[e,":"]}),n.jsx(me,{variant:"determinate",value:100*t,sx:{flexGrow:1,height:6,borderRadius:3}}),n.jsxs(g,{variant:"body2",sx:{minWidth:50,textAlign:"right"},children:[(100*t).toFixed(1),"%"]})]},e))})]})})})(i.sentiment),i.technicalReport&&n.jsx(Z,{sx:{mb:3},children:n.jsxs(he,{children:[n.jsxs(C,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[n.jsxs(g,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:["ðŸ”¬ Technical Analysis Report",n.jsx(E,{label:"Detailed",size:"small",color:"info"})]}),n.jsx(f,{direction:"row",spacing:1,children:n.jsx(ge,{title:"Download Report",children:n.jsx(S,{size:"small",onClick:()=>{const e=new Blob([i.technicalReport],{type:"text/plain"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=`technical-report-${(new Date).toISOString().slice(0,10)}.txt`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t),Ae("Technical report downloaded! ðŸ“„")},children:n.jsx(U,{})})})})]}),n.jsx(C,{sx:{p:3,backgroundColor:"dark"===e.palette.mode?"grey.900":"grey.50",borderRadius:2,border:"1px solid",borderColor:"divider",position:"relative"},children:n.jsx(g,{variant:"body2",sx:{fontFamily:"monospace",whiteSpace:"pre-line",fontSize:"0.9rem",lineHeight:1.6,color:"text.primary",pr:6},children:i.technicalReport})}),n.jsx(C,{sx:{display:"flex",gap:1,flexWrap:"wrap",mt:2},children:n.jsx($,{size:"small",variant:"outlined",color:"primary",onClick:()=>{const e={timestamp:(new Date).toISOString(),duration:i.duration,content:i.technicalReport,wordCount:i.technicalReport.split(/\s+/).length,characterCount:i.technicalReport.length},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`speech-analysis-report-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s),Ae("Report exported! ðŸ“Š")},children:"Export JSON"})})]})}),i.genAIInsights&&n.jsx(Z,{sx:{mb:3,border:"1px solid",borderColor:"success.light"},children:n.jsxs(he,{children:[n.jsxs(C,{sx:{display:"flex",alignItems:"center",mb:3},children:[n.jsx(v,{sx:{bgcolor:"success.main",color:"white",mr:2},children:"ðŸ§ "}),n.jsx(g,{variant:"h6",sx:{fontWeight:600,color:"success.main"},children:"AI Wellness Advisor"}),n.jsx(E,{label:"Powered by Llama 3",size:"small",sx:{ml:2,backgroundColor:"success.light",color:"success.main"}})]}),n.jsx(C,{sx:{p:3,backgroundColor:"rgba(46, 125, 50, 0.05)",borderRadius:2,border:"1px solid",borderColor:"success.light"},children:(t=>{if(!t)return"";const s=t.split(/\*\*([^*]+):\*\*/),r=[];for(let i=0;i<s.length;i++)if(i%2==0){if(s[i].trim()){s[i].split("\n").filter(e=>e.trim()).forEach((t,s)=>{const a=t.trim();if(a){const t=a.match(/^(\d+)\.\s*\*\*([^*]+)\*\*:\s*(.+)$/);if(t)r.push(n.jsxs(C,{sx:{mb:2},children:[n.jsxs(g,{variant:"h6",sx:{fontWeight:600,color:"primary.main",mb:1},children:[t[1],". ",t[2]]}),n.jsx(g,{variant:"body1",sx:{color:"text.secondary",lineHeight:1.6},children:t[3]})]},`${i}-${s}`));else if(a.match(/^\d+\./)){const[t,...o]=a.split(/\.\s*/);r.push(n.jsxs(g,{variant:"body1",sx:{mb:1.5,color:"text.primary"},children:[n.jsxs("strong",{style:{color:e.palette.primary.main},children:[t,"."]})," ",o.join(". ")]},`${i}-${s}`))}else r.push(n.jsx(g,{variant:"body1",sx:{mb:1.5,color:"text.primary",lineHeight:1.6},children:a},`${i}-${s}`))}})}}else r.push(n.jsxs(g,{variant:"h5",sx:{fontWeight:700,color:"success.main",mb:2,mt:3},children:["ðŸŒŸ ",s[i]]},i));return n.jsx(C,{children:r})})(i.genAIInsights)})]})})]})}),n.jsxs(se,{ariaLabel:"Quick Actions",sx:{position:"fixed",bottom:24,right:24},icon:n.jsx(ie,{}),direction:"up",children:[n.jsx(re,{icon:n.jsx(X,{}),tooltipTitle:"Reset All",onClick:()=>{Me(),a(null),We()}}),n.jsx(re,{icon:n.jsx(J,{}),tooltipTitle:"Share Analysis",onClick:()=>{i&&(navigator.clipboard.writeText(JSON.stringify(i,null,2)),Ae("Analysis copied to clipboard! ðŸ“‹"))}}),n.jsx(re,{icon:n.jsx(z,{}),tooltipTitle:"View History",onClick:()=>r("history")})]}),h&&n.jsx($e,{open:h,onClose:()=>{m(!1),b(null)},maxWidth:"sm",fullWidth:!0,children:n.jsx(Ue,{sx:{p:0},children:n.jsx(st,{analysisResult:y,onClose:()=>{m(!1),b(null)}})})})]})};export{nt as SpeechAnalysis};
