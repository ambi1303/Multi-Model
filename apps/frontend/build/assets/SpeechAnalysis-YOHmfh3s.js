import{n as e,o as t,r as s,p as r,q as i,s as a,j as n,t as o,v as l,w as c,x as d,y as p,z as u,D as x,M as h,G as m,T as g,h as y,g as b,i as j,J as f,f as v,E as w,B as C,K as k,I as S,N as R,O as W,Q as A,W as I,X as D,a as $,Y as T,b as E,C as M,Z as P,$ as B,a0 as z,a1 as F,m as N,c as L,P as U,a2 as O,a3 as Y,a4 as G,a5 as H,a6 as K,a7 as _,a8 as X,l as J,a9 as q,k as Q,aa as V}from"./index-ElRkoE7H.js";import{B as Z,u as ee,E as te,G as se,a as re,S as ie,b as ae,c as ne,g as oe}from"./useAnalysisProgress-DNHh7tQu.js";import{T as le}from"./TextField-CuVneWw0.js";import{u as ce}from"./useControlled-DkdrZMW3.js";import{a as de,S as pe}from"./Slider-goSNBFZJ.js";import{T as ue,a as xe}from"./Tabs-CJWctcvf.js";import{G as he}from"./Grid-fyuf3ZOW.js";import{C as me}from"./CardContent-pA9q4iIg.js";import{L as ge}from"./LinearProgress-DFy9WXl8.js";import{T as ye}from"./Tooltip-Dfd2uGR6.js";import{L as be}from"./ListItemAvatar-EoNHZ0zj.js";import{C as je}from"./Collapse-DsgXf-Fe.js";import"./Zoom-Q1JIgiGM.js";import"./Card-BQ_SP2w_.js";import"./FormControl-CTkNbEnO.js";function fe(t){return e("MuiCardActions",t)}t("MuiCardActions",["root","spacing"]);const ve=["disableSpacing","className"],we=o("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.disableSpacing&&t.spacing]}})(({ownerState:e})=>a({display:"flex",alignItems:"center",padding:8},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Ce=s.forwardRef(function(e,t){const s=r({props:e,name:"MuiCardActions"}),{disableSpacing:o=!1,className:d}=s,p=i(s,ve),u=a({},s,{disableSpacing:o}),x=(e=>{const{classes:t,disableSpacing:s}=e;return c({root:["root",!s&&"spacing"]},fe,t)})(u);return n.jsx(we,a({className:l(x.root,d),ownerState:u,ref:t},p))});function ke(t){return e("MuiDialog",t)}const Se=t("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),Re=s.createContext({}),We=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],Ae=o(m,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),Ie=o(h,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),De=o("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.container,t[`scroll${x(s.scroll)}`]]}})(({ownerState:e})=>a({height:"100%","@media print":{height:"auto"},outline:0},"paper"===e.scroll&&{display:"flex",justifyContent:"center",alignItems:"center"},"body"===e.scroll&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),$e=o(p,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.paper,t[`scrollPaper${x(s.scroll)}`],t[`paperWidth${x(String(s.maxWidth))}`],s.fullWidth&&t.paperFullWidth,s.fullScreen&&t.paperFullScreen]}})(({theme:e,ownerState:t})=>a({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},"paper"===t.scroll&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},"body"===t.scroll&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!t.maxWidth&&{maxWidth:"calc(100% - 64px)"},"xs"===t.maxWidth&&{maxWidth:"px"===e.breakpoints.unit?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${Se.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}},t.maxWidth&&"xs"!==t.maxWidth&&{maxWidth:`${e.breakpoints.values[t.maxWidth]}${e.breakpoints.unit}`,[`&.${Se.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[t.maxWidth]+64)]:{maxWidth:"calc(100% - 64px)"}}},t.fullWidth&&{width:"calc(100% - 64px)"},t.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${Se.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),Te=s.forwardRef(function(e,t){const o=r({props:e,name:"MuiDialog"}),h=d(),m={enter:h.transitions.duration.enteringScreen,exit:h.transitions.duration.leavingScreen},{"aria-describedby":g,"aria-labelledby":y,BackdropComponent:b,BackdropProps:j,children:f,className:v,disableEscapeKeyDown:w=!1,fullScreen:C=!1,fullWidth:k=!1,maxWidth:S="sm",onBackdropClick:R,onClick:W,onClose:A,open:I,PaperComponent:D=p,PaperProps:$={},scroll:T="paper",TransitionComponent:E=u,transitionDuration:M=m,TransitionProps:P}=o,B=i(o,We),z=a({},o,{disableEscapeKeyDown:w,fullScreen:C,fullWidth:k,maxWidth:S,scroll:T}),F=(e=>{const{classes:t,scroll:s,maxWidth:r,fullWidth:i,fullScreen:a}=e,n={root:["root"],container:["container",`scroll${x(s)}`],paper:["paper",`paperScroll${x(s)}`,`paperWidth${x(String(r))}`,i&&"paperFullWidth",a&&"paperFullScreen"]};return c(n,ke,t)})(z),N=s.useRef(),L=ce(y),U=s.useMemo(()=>({titleId:L}),[L]);return n.jsx(Ie,a({className:l(F.root,v),closeAfterTransition:!0,components:{Backdrop:Ae},componentsProps:{backdrop:a({transitionDuration:M,as:b},j)},disableEscapeKeyDown:w,onClose:A,open:I,ref:t,onClick:e=>{W&&W(e),N.current&&(N.current=null,R&&R(e),A&&A(e,"backdropClick"))},ownerState:z},B,{children:n.jsx(E,a({appear:!0,in:I,timeout:M,role:"presentation"},P,{children:n.jsx(De,{className:l(F.container),onMouseDown:e=>{N.current=e.target===e.currentTarget},ownerState:z,children:n.jsx($e,a({as:D,elevation:24,role:"dialog","aria-describedby":g,"aria-labelledby":L},$,{className:l(F.paper,$.className),ownerState:z,children:n.jsx(Re.Provider,{value:U,children:f})}))})}))}))});function Ee(t){return e("MuiDialogActions",t)}t("MuiDialogActions",["root","spacing"]);const Me=["className","disableSpacing"],Pe=o("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.disableSpacing&&t.spacing]}})(({ownerState:e})=>a({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Be=s.forwardRef(function(e,t){const s=r({props:e,name:"MuiDialogActions"}),{className:o,disableSpacing:d=!1}=s,p=i(s,Me),u=a({},s,{disableSpacing:d}),x=(e=>{const{classes:t,disableSpacing:s}=e;return c({root:["root",!s&&"spacing"]},Ee,t)})(u);return n.jsx(Pe,a({className:l(x.root,o),ownerState:u,ref:t},p))});function ze(t){return e("MuiDialogContent",t)}function Fe(t){return e("MuiDialogTitle",t)}t("MuiDialogContent",["root","dividers"]);const Ne=t("MuiDialogTitle",["root"]),Le=["className","dividers"],Ue=o("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.dividers&&t.dividers]}})(({theme:e,ownerState:t})=>a({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},t.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${Ne.root} + &`]:{paddingTop:0}})),Oe=s.forwardRef(function(e,t){const s=r({props:e,name:"MuiDialogContent"}),{className:o,dividers:d=!1}=s,p=i(s,Le),u=a({},s,{dividers:d}),x=(e=>{const{classes:t,dividers:s}=e;return c({root:["root",s&&"dividers"]},ze,t)})(u);return n.jsx(Ue,a({className:l(x.root,o),ownerState:u,ref:t},p))}),Ye=["className","id"],Ge=o(g,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),He=s.forwardRef(function(e,t){const o=r({props:e,name:"MuiDialogTitle"}),{className:d,id:p}=o,u=i(o,Ye),x=o,h=(e=>{const{classes:t}=e;return c({root:["root"]},Fe,t)})(x),{titleId:m=p}=s.useContext(Re);return n.jsx(Ge,a({component:"h2",className:l(h.root,d),ownerState:x,ref:t,variant:"h6",id:null!=p?p:m},u))}),Ke=async e=>{const t=new FormData;t.append("audio_file",e,"audio.webm");const s=(await y.post("/analyze-speech",t,{headers:{"Content-Type":"multipart/form-data"}})).data;return{transcription:s.transcription,sentiment:s.sentiment,emotions:s.emotions,genAIInsights:s.genAIInsights,technicalReport:s.technicalReport,duration:0,timestamp:Date.now()}},_e=async()=>(await y.get("/emo-buddy/availability")).data,Xe=async e=>(await y.post("/emo-buddy/start",{analysis_report:e})).data,Je=async(e,t)=>(await y.post("/emo-buddy/continue",{session_id:e,user_input:t})).data,qe=async e=>(await y.post("/emo-buddy/end",{session_id:e})).data,Qe=o(p)(({theme:e})=>({position:"fixed",bottom:20,right:20,padding:e.spacing(2),borderRadius:20,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,color:e.palette.primary.contrastText,boxShadow:e.shadows[8],cursor:"pointer",transition:"all 0.3s ease",zIndex:1400,maxWidth:300,"&:hover":{transform:"translateY(-2px)",boxShadow:e.shadows[12]}})),Ve=o(p)(({theme:e})=>({position:"fixed",bottom:100,right:20,width:380,height:500,display:"flex",flexDirection:"column",borderRadius:16,overflow:"hidden",boxShadow:e.shadows[16],zIndex:1300,background:e.palette.background.paper})),Ze=o(C)(({theme:e})=>({background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,color:e.palette.primary.contrastText,padding:e.spacing(2),display:"flex",alignItems:"center",justifyContent:"space-between"})),et=o(C)(({theme:e})=>({flex:1,padding:e.spacing(1),overflowY:"auto",display:"flex",flexDirection:"column",gap:e.spacing(1),background:de(e.palette.background.default,.5)})),tt=o(C,{shouldForwardProp:e=>"isUser"!==e&&T(e)})(({theme:e,isUser:t})=>({maxWidth:"80%",padding:e.spacing(1,2),borderRadius:16,background:t?e.palette.primary.main:e.palette.action.hover,color:t?e.palette.primary.contrastText:e.palette.text.primary,alignSelf:t?"flex-end":"flex-start",wordWrap:"break-word",animation:"slideIn 0.3s ease","@keyframes slideIn":{from:{opacity:0,transform:"translateY(10px)"},to:{opacity:1,transform:"translateY(0)"}}})),st=o(C)(({theme:e})=>({padding:e.spacing(2),borderTop:`1px solid ${e.palette.divider}`,display:"flex",alignItems:"center",gap:e.spacing(1)})),rt=({analysisResult:e,onClose:t})=>{d();const{showError:r,showSuccess:i}=j(),[a,o]=s.useState(!0),[l,c]=s.useState(!1),[p,x]=s.useState([]),[h,m]=s.useState(""),[y,b]=s.useState(!1),[T,E]=s.useState(null),[M,P]=s.useState(!1),[B,z]=s.useState(!1),F=s.useRef(null),N=s.useRef(null),L=s.useRef(0),U=s.useRef(0);s.useEffect(()=>{var e;null==(e=F.current)||e.scrollIntoView({behavior:"smooth"})},[p]),s.useEffect(()=>{l&&!M&&setTimeout(()=>{var e;return null==(e=N.current)?void 0:e.focus()},100)},[l,M]);const O=async()=>{const e=Date.now();if(e-L.current<2e3)return;if(L.current=e,!h.trim()||!T||y)return;const t={id:Date.now().toString(),content:h.trim(),isUser:!0,timestamp:new Date};x(e=>[...e,t]),m(""),b(!0);try{const e=await Je(T.session_id,t.content),s={id:(Date.now()+1).toString(),content:e.response,isUser:!1,timestamp:new Date};x(e=>[...e,s]),e.should_continue||setTimeout(()=>{z(!0)},2e3)}catch(s){console.error("Failed to send message:",s),r("Failed to send message. Please try again.")}finally{b(!1)}};return n.jsxs(n.Fragment,{children:[n.jsx(u,{in:a,children:n.jsx(Qe,{onClick:async()=>{if(e){o(!1),b(!0);try{if(!(await _e()).available)return void r("Emo Buddy is currently unavailable. Please try again later.");const t=await Xe(e);E(t);const s={id:Date.now().toString(),content:t.response,isUser:!1,timestamp:new Date};x([s]),c(!0),i("Emo Buddy session started! ðŸ¤–")}catch(t){console.error("Failed to start Emo Buddy session:",t),r("Failed to start Emo Buddy session. Please try again.")}finally{b(!1)}}else r("No analysis result available for Emo Buddy session.")},children:n.jsxs(f,{direction:"row",alignItems:"center",spacing:2,children:[n.jsx(Z,{badgeContent:"!",color:"error",children:n.jsx(v,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)"},children:n.jsx(w,{})})}),n.jsxs(C,{children:[n.jsx(g,{variant:"subtitle2",fontWeight:"bold",children:"Emo Buddy wants to talk! ðŸ¤–"}),n.jsx(g,{variant:"caption",sx:{opacity:.9},children:"I can help with your emotional wellbeing"})]})]})})}),n.jsx(k,{direction:"up",in:l,children:n.jsxs(Ve,{children:[n.jsxs(Ze,{children:[n.jsxs(f,{direction:"row",alignItems:"center",spacing:2,children:[n.jsx(v,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)"},children:n.jsx(w,{})}),n.jsxs(C,{children:[n.jsx(g,{variant:"h6",children:"Emo Buddy"}),n.jsx(g,{variant:"caption",sx:{opacity:.8},children:"Your therapeutic companion"})]})]}),n.jsxs(f,{direction:"row",spacing:1,children:[n.jsx(S,{size:"small",onClick:()=>P(!M),sx:{color:"inherit"},children:M?n.jsx(R,{}):n.jsx(W,{})}),n.jsx(S,{size:"small",onClick:()=>z(!0),sx:{color:"inherit"},children:n.jsx(A,{})})]})]}),!M&&n.jsxs(n.Fragment,{children:[n.jsxs(et,{children:[p.map(e=>n.jsx(tt,{isUser:e.isUser,children:n.jsx(g,{variant:"body2",children:e.content})},e.id)),y&&n.jsx(tt,{isUser:!1,children:n.jsxs(f,{direction:"row",alignItems:"center",spacing:1,children:[n.jsx(I,{size:16}),n.jsx(g,{variant:"body2",children:"Emo Buddy is typing..."})]})}),n.jsx("div",{ref:F})]}),n.jsxs(st,{children:[n.jsx(le,{ref:N,fullWidth:!0,placeholder:"Type your message...",value:h,onChange:e=>m(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),O())},disabled:y,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:20}}}),n.jsx(S,{onClick:O,disabled:!h.trim()||y,color:"primary",children:n.jsx(D,{})})]})]})]})}),n.jsxs(Te,{open:B,onClose:()=>z(!1),children:[n.jsx(He,{children:"End Emo Buddy Session?"}),n.jsx(Oe,{children:n.jsx(g,{children:"Are you sure you want to end your therapeutic session with Emo Buddy? Your conversation will be summarized and saved for your records."})}),n.jsxs(Be,{children:[n.jsx($,{onClick:()=>z(!1),children:"Continue Chat"}),n.jsx($,{onClick:async()=>{const e=Date.now();if(!(e-U.current<2e3)&&(U.current=e,T))try{await qe(T.session_id),i("Emo Buddy session ended. Take care! ðŸ’™"),c(!1),z(!1),t()}catch(s){console.error("Failed to end session:",s),r("Failed to end session properly.")}},variant:"contained",color:"primary",children:"End Session"})]})]})]})},it=o(C)(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",gap:e.spacing(.5),height:60,padding:e.spacing(1),borderRadius:e.shape.borderRadius,background:`linear-gradient(135deg, ${e.palette.primary.light}20, ${e.palette.secondary.light}20)`,border:`1px solid ${e.palette.divider}`})),at=o(C)(({theme:e,isActive:t,height:s})=>({width:4,height:`${s}px`,backgroundColor:t?e.palette.primary.main:e.palette.grey[400],borderRadius:2,transition:"all 0.3s ease",animation:t?"wave 1.5s ease-in-out infinite":"none","@keyframes wave":{"0%, 100%":{transform:"scaleY(1)"},"50%":{transform:"scaleY(1.5)"}}})),nt=o($)(({theme:e,isRecording:t})=>({width:120,height:120,borderRadius:"50%",fontSize:"2.5rem",transition:"all 0.3s ease",background:t?`linear-gradient(135deg, ${e.palette.error.main}, ${e.palette.error.dark})`:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.primary.dark})`,boxShadow:t?e.shadows[8]:e.shadows[4],animation:t?"pulse 2s infinite":"none","&:hover":{transform:"scale(1.05)",boxShadow:e.shadows[12]},"@keyframes pulse":{"0%":{transform:"scale(1)",opacity:1},"50%":{transform:"scale(1.1)",opacity:.8},"100%":{transform:"scale(1)",opacity:1}}})),ot=()=>{const e=d(),[t,r]=s.useState("record"),[i,a]=s.useState(null),[o,l]=s.useState(!1),[c,x]=s.useState(!1),[h,m]=s.useState(!1),[y,b]=s.useState(null),k=s.useRef(null),{isRecording:R,audioBlob:W,duration:A,error:I,start:D,stop:T,reset:le}=(()=>{const[e,t]=s.useState(!1),[r,i]=s.useState(null),[a,n]=s.useState(0),[o,l]=s.useState(null),c=s.useRef(null),d=s.useRef(null),p=s.useRef(null),u=s.useRef([]),x=s.useCallback(async()=>{try{l(null),i(null),n(0),u.current=[];const e=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}});d.current=e;const s=new MediaRecorder(e,{mimeType:MediaRecorder.isTypeSupported("audio/webm")?"audio/webm":"audio/mp4"});c.current=s,s.ondataavailable=e=>{e.data.size>0&&u.current.push(e.data)},s.onstop=()=>{const e=new Blob(u.current,{type:s.mimeType||"audio/webm"});i(e),d.current&&(d.current.getTracks().forEach(e=>e.stop()),d.current=null)},s.start(100),t(!0),p.current=setInterval(()=>{n(e=>e+1)},1e3)}catch(e){const t=e;let s="Failed to access microphone";"NotAllowedError"===t.name?s="Microphone access denied. Please allow microphone permissions.":"NotFoundError"===t.name&&(s="No microphone found. Please connect a microphone and try again."),l(s)}},[]),h=s.useCallback(()=>{c.current&&e&&(c.current.stop(),t(!1),p.current&&(clearInterval(p.current),p.current=null))},[e]),m=s.useCallback(()=>{h(),i(null),n(0),l(null),u.current=[]},[h]);return s.useEffect(()=>()=>{p.current&&clearInterval(p.current),d.current&&d.current.getTracks().forEach(e=>e.stop())},[]),{isRecording:e,audioBlob:r,duration:a,error:o,start:x,stop:h,reset:m}})(),{progress:ce,isLoading:de,startProgress:fe,completeProgress:ve}=ee(),{settings:we,updateSetting:ke}=(()=>{const[e,t]=s.useState({quality:"high",noiseReduction:!0,echoCancellation:!0,autoGain:!0,sensitivity:50});return{settings:e,updateSetting:s.useCallback((e,s)=>{t(t=>({...t,[e]:s}))},[])}})(),{history:Se,addAnalysis:Re,clearHistory:We}=(()=>{const[e,t]=s.useState([]);return{history:e,addAnalysis:s.useCallback(e=>{t(t=>[...t.slice(-4),e])},[]),clearHistory:s.useCallback(()=>{t([])},[])}})(),{showSuccess:Ae,showError:Ie}=j(),{addAnalysisResult:De}=E(),$e=s.useCallback(e=>`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`,[]),Ee=s.useCallback(()=>{if(W)if(c&&k.current)k.current.pause(),x(!1);else{k.current&&k.current.pause();const e=new Audio(URL.createObjectURL(W));k.current=e,e.onended=()=>x(!1),e.onerror=()=>{Ie("Failed to play audio."),x(!1)},e.play().then(()=>x(!0)).catch(()=>{Ie("Failed to play audio."),x(!1)})}},[W,c,Ie]),Me=s.useCallback(()=>{if(!W)return;const e=URL.createObjectURL(W),t=`speech-analysis-${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.webm`,s=document.createElement("a");s.href=e,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(e),Ae(`Audio saved as ${t} ðŸ“`)},[W,Ae]),Pe=s.useCallback(()=>{le(),a(null),k.current&&k.current.pause(),x(!1)},[le]),Be=()=>{i?(b(i),m(!0)):Ie("No analysis result available for EmoBuddy.")},ze=()=>{const e=Array.from({length:20},(e,t)=>n.jsx(at,{isActive:R,height:40*Math.random()+10,sx:{animationDelay:.1*t+"s"}},t));return n.jsx(it,{children:e})};return n.jsxs(C,{sx:{maxWidth:1200,mx:"auto",p:3},children:[n.jsxs(C,{sx:{textAlign:"center",mb:4,opacity:0,animation:"slideInDown 0.8s ease-out forwards","@keyframes slideInDown":{"0%":{opacity:0,transform:"translateY(-30px)"},"100%":{opacity:1,transform:"translateY(0)"}}},children:[n.jsx(g,{variant:"h3",component:"h1",sx:{fontWeight:700,mb:2,background:`linear-gradient(45deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"ðŸŽ¤ Smart Speech Analysis"}),n.jsx(g,{variant:"h6",color:"text.secondary",sx:{mb:3},children:"Record and analyze emotions from speech patterns and vocal characteristics"}),n.jsxs(f,{direction:"row",spacing:2,justifyContent:"center",sx:{mb:3},children:[n.jsx(M,{icon:n.jsx(P,{}),label:`${Se.length} Analyses`,color:"primary",variant:"outlined"}),n.jsx(M,{icon:n.jsx(w,{}),label:"Real-time AI",color:"secondary",variant:"outlined"}),n.jsx(M,{icon:n.jsx(B,{}),label:"Enhanced UX",color:"success",variant:"outlined"})]})]}),n.jsx(p,{sx:{mb:3},children:n.jsxs(ue,{value:t,onChange:(e,t)=>{r(t)},variant:"fullWidth",children:[n.jsx(xe,{label:"Record & Analyze",value:"record",icon:n.jsx(z,{}),iconPosition:"start"}),n.jsx(xe,{label:"Analysis History",value:"history",icon:n.jsx(F,{}),iconPosition:"start"})]})}),"record"===t&&n.jsxs(he,{container:!0,spacing:4,children:[n.jsx(he,{item:!0,xs:12,md:6,children:n.jsxs(te,{sx:{mb:4},children:[n.jsxs(me,{children:[n.jsx(g,{variant:"h5",sx:{fontWeight:600,mb:4},children:"ðŸŽ™ï¸ Audio Recording"}),n.jsx(C,{sx:{mb:4},children:n.jsx(nt,{isRecording:R,onClick:R?T:D,variant:"contained",disabled:de,children:R?n.jsx(Q,{}):n.jsx(z,{})})}),n.jsx(g,{variant:"h3",sx:{fontFamily:"monospace",fontWeight:700,mb:2,color:R?"error.main":"text.primary"},children:$e(A)}),R&&n.jsxs(C,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:1,mb:3},children:[n.jsx(C,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:"error.main",animation:"blink 1s infinite","@keyframes blink":{"0%, 50%":{opacity:1},"51%, 100%":{opacity:0}}}}),n.jsx(g,{variant:"body2",color:"error.main",sx:{fontWeight:500},children:"Recording in progress..."})]}),ze(),n.jsxs(f,{spacing:2,sx:{mt:3},children:[n.jsx($,{variant:"outlined",startIcon:n.jsx(J,{}),onClick:Pe,fullWidth:!0,disabled:R||de,children:"Reset Recording"}),n.jsx($,{variant:"outlined",startIcon:n.jsx(V,{}),onClick:()=>l(!o),fullWidth:!0,children:"Audio Settings"})]}),n.jsx(je,{in:o,children:n.jsxs(te,{interactive:!1,sx:{mt:2,p:2,bgcolor:"background.default"},children:[n.jsx(g,{variant:"subtitle2",sx:{mb:2,fontWeight:"bold"},children:"ðŸ”§ Recording Settings"}),n.jsxs(f,{spacing:2,children:[n.jsxs(C,{children:[n.jsx(g,{variant:"body2",sx:{mb:1},children:"Microphone Sensitivity"}),n.jsx(pe,{value:we.sensitivity,onChange:(e,t)=>ke("sensitivity",t),min:0,max:100,step:10,marks:!0,valueLabelDisplay:"auto"})]}),n.jsxs(f,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:[n.jsx(M,{label:"Noise Reduction",color:we.noiseReduction?"primary":"default",onClick:()=>ke("noiseReduction",!we.noiseReduction),clickable:!0}),n.jsx(M,{label:"Echo Cancellation",color:we.echoCancellation?"primary":"default",onClick:()=>ke("echoCancellation",!we.echoCancellation),clickable:!0}),n.jsx(M,{label:"Auto Gain",color:we.autoGain?"primary":"default",onClick:()=>ke("autoGain",!we.autoGain),clickable:!0})]})]})]})}),I&&n.jsx(N,{severity:"error",sx:{mt:2},children:I})]}),n.jsxs(Ce,{sx:{justifyContent:"space-between",p:2,flexWrap:"wrap",gap:2},children:[n.jsx($,{startIcon:n.jsx(J,{}),onClick:Pe,color:"secondary",children:"Analyze New Audio"}),n.jsx(se,{startIcon:n.jsx(w,{}),onClick:Be,children:"Ask EmoBuddy"})]})]})}),n.jsx(he,{item:!0,xs:12,md:6,children:n.jsx(te,{children:n.jsxs(me,{sx:{p:4},children:[n.jsx(g,{variant:"h5",sx:{fontWeight:600,mb:3},children:"ðŸŽµ Audio Analysis"}),W?n.jsxs(C,{children:[n.jsxs(N,{severity:"success",sx:{mb:3},children:[n.jsx(g,{variant:"subtitle2",sx:{fontWeight:600},children:"Recording Ready for Analysis"}),n.jsxs(g,{variant:"body2",children:["Duration: ",$e(A)," â€¢ Size: ",(W.size/1024).toFixed(1)," KB"]})]}),ce>0&&n.jsx(u,{in:!0,children:n.jsxs(C,{sx:{mb:3},children:[n.jsx(ge,{variant:"determinate",value:ce,sx:{height:8,borderRadius:4,"& .MuiLinearProgress-bar":{borderRadius:4,background:`linear-gradient(45deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`}}}),n.jsxs(g,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:["Analyzing audio... ",ce.toFixed(0),"%"]})]})}),n.jsxs(he,{container:!0,spacing:2,sx:{mb:3},children:[n.jsx(he,{item:!0,xs:4,children:n.jsx(ye,{title:c?"Pause Audio":"Play Audio",children:n.jsx($,{variant:"outlined",startIcon:c?n.jsx(L,{}):n.jsx(U,{}),onClick:Ee,fullWidth:!0,size:"small",children:c?"Pause":"Play"})})}),n.jsx(he,{item:!0,xs:4,children:n.jsx(ye,{title:"Download Audio",children:n.jsx($,{variant:"outlined",startIcon:n.jsx(O,{}),onClick:Me,fullWidth:!0,size:"small",children:"Save"})})}),n.jsx(he,{item:!0,xs:4,children:n.jsx(se,{onClick:async()=>{if(!W)return void Ie("No audio recording available.");const e=fe();try{const e={...await Ke(W),duration:A,timestamp:Date.now()};a(e),Re(e),De("speech",e),Ae("Audio analyzed successfully! ðŸŽ‰"),b(e),setTimeout(()=>{m(!0)},2e3)}catch(t){Ie("Failed to analyze audio. Please try again.")}finally{ve(e)}},loading:de,loadingText:"Analyzing...",size:"small",fullWidth:!0,children:"Analyze"})})]})]}):n.jsxs(C,{sx:{p:4,textAlign:"center",backgroundColor:"dark"===e.palette.mode?"grey.900":"grey.50",borderRadius:2,border:"2px dashed",borderColor:"divider"},children:[n.jsx(C,{sx:{fontSize:48,color:"text.secondary",mb:2},children:n.jsx(Y,{})}),n.jsx(g,{variant:"h6",color:"text.secondary",children:"No recording available"}),n.jsx(g,{variant:"body2",color:"text.secondary",children:"Start recording to analyze speech"})]})]})})})]}),"history"===t&&n.jsx(te,{children:n.jsxs(me,{children:[n.jsxs(C,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[n.jsx(g,{variant:"h5",sx:{fontWeight:600},children:"ðŸ“š Analysis History"}),n.jsx($,{variant:"outlined",startIcon:n.jsx(G,{}),onClick:We,disabled:0===Se.length,color:"error",children:"Clear All"})]}),Se.length>0?n.jsx(H,{sx:{width:"100%"},children:Se.reverse().map((e,t)=>{var s;return n.jsxs(K,{sx:{mb:2,border:"1px solid",borderColor:"divider",borderRadius:2,bgcolor:"background.paper"},children:[n.jsx(be,{children:n.jsx(v,{sx:{bgcolor:"primary.main"},children:n.jsx(_,{})})}),n.jsx(X,{primary:n.jsxs(g,{variant:"subtitle1",sx:{fontWeight:600},children:["Analysis #",Se.length-t]}),secondary:n.jsxs(C,{children:[n.jsx(g,{variant:"body2",color:"text.secondary",children:new Date(e.timestamp).toLocaleString()}),n.jsxs(g,{variant:"body2",color:"text.secondary",children:["Duration: ",$e(e.duration)," â€¢ Sentiment: ",(null==(s=e.sentiment)?void 0:s.label)||"N/A"]}),e.emotions&&e.emotions.length>0&&n.jsx(C,{sx:{mt:1},children:n.jsx(re,{emotion:e.emotions[0].emotion})})]})})]},t)})}):n.jsxs(C,{sx:{textAlign:"center",py:4},children:[n.jsx(g,{variant:"h6",color:"text.secondary",children:"No analysis history yet"}),n.jsx(g,{variant:"body2",color:"text.secondary",children:"Start recording and analyzing speech to see your history here"})]})]})}),i&&!de&&"record"===t&&n.jsx(u,{in:!0,timeout:800,children:n.jsxs(C,{sx:{mt:4},children:[i.transcription&&n.jsxs(te,{sx:{mb:3},children:[n.jsxs(me,{children:[n.jsxs(g,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:["ðŸ“ Transcription",n.jsx(M,{label:"AI Generated",size:"small",color:"primary"})]}),n.jsxs(g,{variant:"body1",sx:{p:2,backgroundColor:"dark"===e.palette.mode?"grey.900":"grey.50",borderRadius:2,fontStyle:"italic",lineHeight:1.6},children:['"',i.transcription,'"']})]}),n.jsx(Ce,{sx:{p:2,justifyContent:"flex-end"},children:n.jsx(se,{startIcon:n.jsx(w,{}),onClick:Be,children:"Ask EmoBuddy"})})]}),i.emotions&&(e=>{if(!e||0===e.length)return null;const t=e.sort((e,t)=>t.confidence-e.confidence).slice(0,5);return n.jsx(te,{sx:{mb:3},children:n.jsxs(me,{children:[n.jsxs(g,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:["ðŸ˜Š Emotion Analysis",n.jsx(Z,{badgeContent:e.length,color:"primary"})]}),n.jsx(f,{spacing:2,children:t.map((e,t)=>n.jsxs(C,{sx:{display:"flex",alignItems:"center",gap:2},children:[n.jsx(re,{emotion:e.emotion}),n.jsx(C,{sx:{flexGrow:1},children:n.jsx(ge,{variant:"determinate",value:100*e.confidence,sx:{height:8,borderRadius:4,"& .MuiLinearProgress-bar":{borderRadius:4,background:oe(e.emotion).color}}})}),n.jsxs(g,{variant:"body2",sx:{minWidth:50,textAlign:"right"},children:[(100*e.confidence).toFixed(1),"%"]})]},t))})]})})})(i.emotions),i.sentiment&&(e=>{if(!e)return null;const t="positive"===e.label?"success":"negative"===e.label?"error":"warning";return n.jsx(te,{sx:{mb:3},children:n.jsxs(me,{children:[n.jsx(g,{variant:"h6",sx:{mb:2},children:"ðŸ’­ Sentiment Analysis"}),n.jsxs(C,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[n.jsx(M,{label:e.label.toUpperCase(),color:t,sx:{fontWeight:"bold"}}),n.jsxs(g,{variant:"body1",children:["Confidence: ",(100*e.confidence).toFixed(1),"%"]})]}),e.scores&&n.jsx(f,{spacing:1,children:Object.entries(e.scores).map(([e,t])=>n.jsxs(C,{sx:{display:"flex",alignItems:"center",gap:2},children:[n.jsxs(g,{variant:"body2",sx:{minWidth:80,textTransform:"capitalize"},children:[e,":"]}),n.jsx(ge,{variant:"determinate",value:100*t,sx:{flexGrow:1,height:6,borderRadius:3}}),n.jsxs(g,{variant:"body2",sx:{minWidth:50,textAlign:"right"},children:[(100*t).toFixed(1),"%"]})]},e))})]})})})(i.sentiment),i.technicalReport&&n.jsx(te,{sx:{mb:3},children:n.jsxs(me,{children:[n.jsxs(C,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[n.jsxs(g,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:["ðŸ”¬ Technical Analysis Report",n.jsx(M,{label:"Detailed",size:"small",color:"info"})]}),n.jsx(f,{direction:"row",spacing:1,children:n.jsx(ye,{title:"Download Report",children:n.jsx(S,{size:"small",onClick:()=>{const e=new Blob([i.technicalReport],{type:"text/plain"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=`technical-report-${(new Date).toISOString().slice(0,10)}.txt`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t),Ae("Technical report downloaded! ðŸ“„")},children:n.jsx(O,{})})})})]}),n.jsx(C,{sx:{p:3,backgroundColor:"dark"===e.palette.mode?"grey.900":"grey.50",borderRadius:2,border:"1px solid",borderColor:"divider",position:"relative"},children:n.jsx(g,{variant:"body2",sx:{fontFamily:"monospace",whiteSpace:"pre-line",fontSize:"0.9rem",lineHeight:1.6,color:"text.primary",pr:6},children:i.technicalReport})}),n.jsx(C,{sx:{display:"flex",gap:1,flexWrap:"wrap",mt:2},children:n.jsx($,{size:"small",variant:"outlined",color:"primary",onClick:()=>{const e={timestamp:(new Date).toISOString(),duration:i.duration,content:i.technicalReport,wordCount:i.technicalReport.split(/\s+/).length,characterCount:i.technicalReport.length},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=`speech-analysis-report-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s),Ae("Report exported! ðŸ“Š")},children:"Export JSON"})})]})}),i.genAIInsights&&n.jsx(te,{sx:{mb:3,border:"1px solid",borderColor:"success.light"},children:n.jsxs(me,{children:[n.jsxs(C,{sx:{display:"flex",alignItems:"center",mb:3},children:[n.jsx(v,{sx:{bgcolor:"success.main",color:"white",mr:2},children:"ðŸ§ "}),n.jsx(g,{variant:"h6",sx:{fontWeight:600,color:"success.main"},children:"AI Wellness Advisor"}),n.jsx(M,{label:"Powered by Llama 3",size:"small",sx:{ml:2,backgroundColor:"success.light",color:"success.main"}})]}),n.jsx(C,{sx:{p:3,backgroundColor:"rgba(46, 125, 50, 0.05)",borderRadius:2,border:"1px solid",borderColor:"success.light"},children:(t=>{if(!t)return"";const s=t.split(/\*\*([^*]+):\*\*/),r=[];for(let i=0;i<s.length;i++)if(i%2==0){if(s[i].trim()){s[i].split("\n").filter(e=>e.trim()).forEach((t,s)=>{const a=t.trim();if(a){const t=a.match(/^(\d+)\.\s*\*\*([^*]+)\*\*:\s*(.+)$/);if(t)r.push(n.jsxs(C,{sx:{mb:2},children:[n.jsxs(g,{variant:"h6",sx:{fontWeight:600,color:"primary.main",mb:1},children:[t[1],". ",t[2]]}),n.jsx(g,{variant:"body1",sx:{color:"text.secondary",lineHeight:1.6},children:t[3]})]},`${i}-${s}`));else if(a.match(/^\d+\./)){const[t,...o]=a.split(/\.\s*/);r.push(n.jsxs(g,{variant:"body1",sx:{mb:1.5,color:"text.primary"},children:[n.jsxs("strong",{style:{color:e.palette.primary.main},children:[t,"."]})," ",o.join(". ")]},`${i}-${s}`))}else r.push(n.jsx(g,{variant:"body1",sx:{mb:1.5,color:"text.primary",lineHeight:1.6},children:a},`${i}-${s}`))}})}}else r.push(n.jsxs(g,{variant:"h5",sx:{fontWeight:700,color:"success.main",mb:2,mt:3},children:["ðŸŒŸ ",s[i]]},i));return n.jsx(C,{children:r})})(i.genAIInsights)})]})})]})}),n.jsxs(ie,{ariaLabel:"Quick Actions",sx:{position:"fixed",bottom:24,right:24},icon:n.jsx(ne,{}),direction:"up",children:[n.jsx(ae,{icon:n.jsx(J,{}),tooltipTitle:"Reset All",onClick:()=>{Pe(),a(null),We()}}),n.jsx(ae,{icon:n.jsx(q,{}),tooltipTitle:"Share Analysis",onClick:()=>{i&&(navigator.clipboard.writeText(JSON.stringify(i,null,2)),Ae("Analysis copied to clipboard! ðŸ“‹"))}}),n.jsx(ae,{icon:n.jsx(F,{}),tooltipTitle:"View History",onClick:()=>r("history")})]}),h&&n.jsx(Te,{open:h,onClose:()=>{m(!1),b(null)},maxWidth:"sm",fullWidth:!0,children:n.jsx(Oe,{sx:{p:0},children:n.jsx(rt,{analysisResult:y,onClose:()=>{m(!1),b(null)}})})})]})};export{ot as SpeechAnalysis};
