import{p as e,q as t,r,s as i,t as a,v as s,w as n,x as o,y as l,j as c,z as d,D as p,G as u,J as x,K as h,O as m,T as g,k as y,i as b,l as j,Q as f,f as v,E as w,B as k,W as C,I as S,X as R,Y as W,$ as A,a0 as D,a1 as I,a as $,b as T,C as E,a2 as P,a3 as B,M as z,a4 as M,m as F,n as L,a5 as N,o as U,c as O,P as Y,a6 as G,a7 as H,a8 as K,a9 as _,aa as X,ab as J,ac as q,ad as Q}from"./index-bax0hkam.js";import{u as V,E as Z,G as ee,a as te,S as re,b as ie,c as ae,g as se}from"./useAnalysisProgress-Dj2d4DNr.js";import{B as ne}from"./Badge-7JWRPwFd.js";import{T as oe}from"./TextField-CU5ktAVN.js";import{u as le}from"./useControlled-CqooemHa.js";import{a as ce,S as de}from"./Slider-Doyl354F.js";import{T as pe,a as ue}from"./Tabs-DL_vm6Ws.js";import{G as xe}from"./Grid-CxIZKtMQ.js";import{C as he}from"./CardContent-DnseBVR8.js";import{C as me}from"./Collapse-hiRvUm_2.js";import{L as ge}from"./LinearProgress-BZKuthGk.js";import{T as ye}from"./Tooltip-q8-MmPg5.js";import{L as be}from"./ListItemAvatar-BCHDk4k6.js";import"./Zoom-Ch21Gzq3.js";import"./Card-n7hRZPZy.js";import"./FormControl-CwjXMIId.js";function je(e){return t("MuiDialog",e)}const fe=e("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),ve=r.createContext({}),we=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],ke=d(m,{name:"MuiDialog",slot:"Backdrop",overrides:(e,t)=>t.backdrop})({zIndex:-1}),Ce=d(h,{name:"MuiDialog",slot:"Root",overridesResolver:(e,t)=>t.root})({"@media print":{position:"absolute !important"}}),Se=d("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.container,t[`scroll${u(r.scroll)}`]]}})(({ownerState:e})=>l({height:"100%","@media print":{height:"auto"},outline:0},"paper"===e.scroll&&{display:"flex",justifyContent:"center",alignItems:"center"},"body"===e.scroll&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),Re=d(s,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.paper,t[`scrollPaper${u(r.scroll)}`],t[`paperWidth${u(String(r.maxWidth))}`],r.fullWidth&&t.paperFullWidth,r.fullScreen&&t.paperFullScreen]}})(({theme:e,ownerState:t})=>l({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},"paper"===t.scroll&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},"body"===t.scroll&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!t.maxWidth&&{maxWidth:"calc(100% - 64px)"},"xs"===t.maxWidth&&{maxWidth:"px"===e.breakpoints.unit?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${fe.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+64)]:{maxWidth:"calc(100% - 64px)"}}},t.maxWidth&&"xs"!==t.maxWidth&&{maxWidth:`${e.breakpoints.values[t.maxWidth]}${e.breakpoints.unit}`,[`&.${fe.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[t.maxWidth]+64)]:{maxWidth:"calc(100% - 64px)"}}},t.fullWidth&&{width:"calc(100% - 64px)"},t.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${fe.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),We=r.forwardRef(function(e,t){const d=i({props:e,name:"MuiDialog"}),h=a(),m={enter:h.transitions.duration.enteringScreen,exit:h.transitions.duration.leavingScreen},{"aria-describedby":g,"aria-labelledby":y,BackdropComponent:b,BackdropProps:j,children:f,className:v,disableEscapeKeyDown:w=!1,fullScreen:k=!1,fullWidth:C=!1,maxWidth:S="sm",onBackdropClick:R,onClick:W,onClose:A,open:D,PaperComponent:I=s,PaperProps:$={},scroll:T="paper",TransitionComponent:E=n,transitionDuration:P=m,TransitionProps:B}=d,z=o(d,we),M=l({},d,{disableEscapeKeyDown:w,fullScreen:k,fullWidth:C,maxWidth:S,scroll:T}),F=(e=>{const{classes:t,scroll:r,maxWidth:i,fullWidth:a,fullScreen:s}=e,n={root:["root"],container:["container",`scroll${u(r)}`],paper:["paper",`paperScroll${u(r)}`,`paperWidth${u(String(i))}`,a&&"paperFullWidth",s&&"paperFullScreen"]};return x(n,je,t)})(M),L=r.useRef(),N=le(y),U=r.useMemo(()=>({titleId:N}),[N]);return c.jsx(Ce,l({className:p(F.root,v),closeAfterTransition:!0,components:{Backdrop:ke},componentsProps:{backdrop:l({transitionDuration:P,as:b},j)},disableEscapeKeyDown:w,onClose:A,open:D,ref:t,onClick:e=>{W&&W(e),L.current&&(L.current=null,R&&R(e),A&&A(e,"backdropClick"))},ownerState:M},z,{children:c.jsx(E,l({appear:!0,in:D,timeout:P,role:"presentation"},B,{children:c.jsx(Se,{className:p(F.container),onMouseDown:e=>{L.current=e.target===e.currentTarget},ownerState:M,children:c.jsx(Re,l({as:I,elevation:24,role:"dialog","aria-describedby":g,"aria-labelledby":N},$,{className:p(F.paper,$.className),ownerState:M,children:c.jsx(ve.Provider,{value:U,children:f})}))})}))}))});function Ae(e){return t("MuiDialogActions",e)}e("MuiDialogActions",["root","spacing"]);const De=["className","disableSpacing"],Ie=d("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableSpacing&&t.spacing]}})(({ownerState:e})=>l({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),$e=r.forwardRef(function(e,t){const r=i({props:e,name:"MuiDialogActions"}),{className:a,disableSpacing:s=!1}=r,n=o(r,De),d=l({},r,{disableSpacing:s}),u=(e=>{const{classes:t,disableSpacing:r}=e;return x({root:["root",!r&&"spacing"]},Ae,t)})(d);return c.jsx(Ie,l({className:p(u.root,a),ownerState:d,ref:t},n))});function Te(e){return t("MuiDialogContent",e)}function Ee(e){return t("MuiDialogTitle",e)}e("MuiDialogContent",["root","dividers"]);const Pe=e("MuiDialogTitle",["root"]),Be=["className","dividers"],ze=d("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,r.dividers&&t.dividers]}})(({theme:e,ownerState:t})=>l({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},t.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${Pe.root} + &`]:{paddingTop:0}})),Me=r.forwardRef(function(e,t){const r=i({props:e,name:"MuiDialogContent"}),{className:a,dividers:s=!1}=r,n=o(r,Be),d=l({},r,{dividers:s}),u=(e=>{const{classes:t,dividers:r}=e;return x({root:["root",r&&"dividers"]},Te,t)})(d);return c.jsx(ze,l({className:p(u.root,a),ownerState:d,ref:t},n))}),Fe=["className","id"],Le=d(g,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),Ne=r.forwardRef(function(e,t){const a=i({props:e,name:"MuiDialogTitle"}),{className:s,id:n}=a,d=o(a,Fe),u=a,h=(e=>{const{classes:t}=e;return x({root:["root"]},Ee,t)})(u),{titleId:m=n}=r.useContext(ve);return c.jsx(Le,l({component:"h2",className:p(h.root,s),ownerState:u,ref:t,variant:"h6",id:null!=n?n:m},d))}),Ue=async e=>{const t=new FormData;t.append("audio_file",e,"audio.webm");const r=(await y.post("/analyze-speech",t,{headers:{"Content-Type":"multipart/form-data"}})).data;return{transcription:r.transcription,sentiment:r.sentiment,emotions:r.emotions,genAIInsights:r.genAIInsights,technicalReport:r.technicalReport,duration:0,timestamp:Date.now()}},Oe=async()=>(await y.get("/emo-buddy/availability")).data,Ye=async e=>(await y.post("/emo-buddy/start",{analysis_report:e})).data,Ge=async(e,t)=>(await y.post("/emo-buddy/continue",{session_id:e,user_input:t})).data,He=async e=>(await y.post("/emo-buddy/end",{session_id:e})).data,Ke=d(s)(({theme:e})=>({position:"fixed",bottom:20,right:20,padding:e.spacing(2),borderRadius:20,background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,color:e.palette.primary.contrastText,boxShadow:e.shadows[8],cursor:"pointer",transition:"all 0.3s ease",zIndex:1400,maxWidth:300,"&:hover":{transform:"translateY(-2px)",boxShadow:e.shadows[12]}})),_e=d(s)(({theme:e})=>({position:"fixed",bottom:100,right:20,width:380,height:500,display:"flex",flexDirection:"column",borderRadius:16,overflow:"hidden",boxShadow:e.shadows[16],zIndex:1300,background:e.palette.background.paper})),Xe=d(k)(({theme:e})=>({background:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,color:e.palette.primary.contrastText,padding:e.spacing(2),display:"flex",alignItems:"center",justifyContent:"space-between"})),Je=d(k)(({theme:e})=>({flex:1,padding:e.spacing(1),overflowY:"auto",display:"flex",flexDirection:"column",gap:e.spacing(1),background:ce(e.palette.background.default,.5)})),qe=d(k)(({theme:e,isUser:t})=>({maxWidth:"80%",padding:e.spacing(1,2),borderRadius:16,background:t?e.palette.primary.main:e.palette.grey[100],color:t?e.palette.primary.contrastText:e.palette.text.primary,alignSelf:t?"flex-end":"flex-start",wordWrap:"break-word",animation:"slideIn 0.3s ease","@keyframes slideIn":{from:{opacity:0,transform:"translateY(10px)"},to:{opacity:1,transform:"translateY(0)"}}})),Qe=d(k)(({theme:e})=>({padding:e.spacing(2),borderTop:`1px solid ${e.palette.divider}`,display:"flex",alignItems:"center",gap:e.spacing(1)})),Ve=({analysisResult:e,onClose:t})=>{a();const{showError:i,showSuccess:s}=j(),[o,l]=r.useState(!0),[d,p]=r.useState(!1),[u,x]=r.useState([]),[h,m]=r.useState(""),[y,b]=r.useState(!1),[T,E]=r.useState(null),[P,B]=r.useState(!1),[z,M]=r.useState(!1),F=r.useRef(null),L=r.useRef(null),N=r.useRef(0),U=r.useRef(0);r.useEffect(()=>{var e;null==(e=F.current)||e.scrollIntoView({behavior:"smooth"})},[u]),r.useEffect(()=>{d&&!P&&setTimeout(()=>{var e;return null==(e=L.current)?void 0:e.focus()},100)},[d,P]);const O=async()=>{const e=Date.now();if(e-N.current<2e3)return;if(N.current=e,!h.trim()||!T||y)return;const t={id:Date.now().toString(),content:h.trim(),isUser:!0,timestamp:new Date};x(e=>[...e,t]),m(""),b(!0);try{const e=await Ge(T.session_id,t.content),r={id:(Date.now()+1).toString(),content:e.response,isUser:!1,timestamp:new Date};x(e=>[...e,r]),e.should_continue||setTimeout(()=>{M(!0)},2e3)}catch(r){console.error("Failed to send message:",r),i("Failed to send message. Please try again.")}finally{b(!1)}};return c.jsxs(c.Fragment,{children:[c.jsx(n,{in:o,children:c.jsx(Ke,{onClick:async()=>{if(e){l(!1),b(!0);try{if(!(await Oe()).available)return void i("Emo Buddy is currently unavailable. Please try again later.");const t=await Ye(e);E(t);const r={id:Date.now().toString(),content:t.response,isUser:!1,timestamp:new Date};x([r]),p(!0),s("Emo Buddy session started! ðŸ¤–")}catch(t){console.error("Failed to start Emo Buddy session:",t),i("Failed to start Emo Buddy session. Please try again.")}finally{b(!1)}}else i("No analysis result available for Emo Buddy session.")},children:c.jsxs(f,{direction:"row",alignItems:"center",spacing:2,children:[c.jsx(ne,{badgeContent:"!",color:"error",children:c.jsx(v,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)"},children:c.jsx(w,{})})}),c.jsxs(k,{children:[c.jsx(g,{variant:"subtitle2",fontWeight:"bold",children:"Emo Buddy wants to talk! ðŸ¤–"}),c.jsx(g,{variant:"caption",sx:{opacity:.9},children:"I can help with your emotional wellbeing"})]})]})})}),c.jsx(C,{direction:"up",in:d,children:c.jsxs(_e,{children:[c.jsxs(Xe,{children:[c.jsxs(f,{direction:"row",alignItems:"center",spacing:2,children:[c.jsx(v,{sx:{bgcolor:"rgba(255, 255, 255, 0.2)"},children:c.jsx(w,{})}),c.jsxs(k,{children:[c.jsx(g,{variant:"h6",children:"Emo Buddy"}),c.jsx(g,{variant:"caption",sx:{opacity:.8},children:"Your therapeutic companion"})]})]}),c.jsxs(f,{direction:"row",spacing:1,children:[c.jsx(S,{size:"small",onClick:()=>B(!P),sx:{color:"inherit"},children:P?c.jsx(R,{}):c.jsx(W,{})}),c.jsx(S,{size:"small",onClick:()=>M(!0),sx:{color:"inherit"},children:c.jsx(A,{})})]})]}),!P&&c.jsxs(c.Fragment,{children:[c.jsxs(Je,{children:[u.map(e=>c.jsx(qe,{isUser:e.isUser,children:c.jsx(g,{variant:"body2",children:e.content})},e.id)),y&&c.jsx(qe,{isUser:!1,children:c.jsxs(f,{direction:"row",alignItems:"center",spacing:1,children:[c.jsx(D,{size:16}),c.jsx(g,{variant:"body2",children:"Emo Buddy is typing..."})]})}),c.jsx("div",{ref:F})]}),c.jsxs(Qe,{children:[c.jsx(oe,{ref:L,fullWidth:!0,placeholder:"Type your message...",value:h,onChange:e=>m(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),O())},disabled:y,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:20}}}),c.jsx(S,{onClick:O,disabled:!h.trim()||y,color:"primary",children:c.jsx(I,{})})]})]})]})}),c.jsxs(We,{open:z,onClose:()=>M(!1),children:[c.jsx(Ne,{children:"End Emo Buddy Session?"}),c.jsx(Me,{children:c.jsx(g,{children:"Are you sure you want to end your therapeutic session with Emo Buddy? Your conversation will be summarized and saved for your records."})}),c.jsxs($e,{children:[c.jsx($,{onClick:()=>M(!1),children:"Continue Chat"}),c.jsx($,{onClick:async()=>{const e=Date.now();if(!(e-U.current<2e3)&&(U.current=e,T))try{await He(T.session_id),s("Emo Buddy session ended. Take care! ðŸ’™"),p(!1),M(!1),t()}catch(r){console.error("Failed to end session:",r),i("Failed to end session properly.")}},variant:"contained",color:"primary",children:"End Session"})]})]})]})},Ze=d(k)(({theme:e})=>({display:"flex",alignItems:"center",justifyContent:"center",gap:e.spacing(.5),height:60,padding:e.spacing(1),borderRadius:e.shape.borderRadius,background:`linear-gradient(135deg, ${e.palette.primary.light}20, ${e.palette.secondary.light}20)`,border:`1px solid ${e.palette.divider}`})),et=d(k)(({theme:e,isActive:t,height:r})=>({width:4,height:`${r}px`,backgroundColor:t?e.palette.primary.main:e.palette.grey[400],borderRadius:2,transition:"all 0.3s ease",animation:t?"wave 1.5s ease-in-out infinite":"none","@keyframes wave":{"0%, 100%":{transform:"scaleY(1)"},"50%":{transform:"scaleY(1.5)"}}})),tt=d($)(({theme:e,isRecording:t})=>({width:120,height:120,borderRadius:"50%",fontSize:"2.5rem",transition:"all 0.3s ease",background:t?`linear-gradient(135deg, ${e.palette.error.main}, ${e.palette.error.dark})`:`linear-gradient(135deg, ${e.palette.primary.main}, ${e.palette.primary.dark})`,boxShadow:t?e.shadows[8]:e.shadows[4],animation:t?"pulse 2s infinite":"none","&:hover":{transform:"scale(1.05)",boxShadow:e.shadows[12]},"@keyframes pulse":{"0%":{transform:"scale(1)",opacity:1},"50%":{transform:"scale(1.1)",opacity:.8},"100%":{transform:"scale(1)",opacity:1}}})),rt=()=>{const e=a(),[t,i]=r.useState("record"),[o,l]=r.useState(null),[d,p]=r.useState(!1),[u,x]=r.useState(!1),[h,m]=r.useState(!1),[y,b]=r.useState(null),C=r.useRef(null),{isRecording:R,audioBlob:W,duration:A,error:D,start:I,stop:oe,reset:le}=(()=>{const[e,t]=r.useState(!1),[i,a]=r.useState(null),[s,n]=r.useState(0),[o,l]=r.useState(null),c=r.useRef(null),d=r.useRef(null),p=r.useRef(null),u=r.useRef([]),x=r.useCallback(async()=>{try{l(null),a(null),n(0),u.current=[];const e=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}});d.current=e;const r=new MediaRecorder(e,{mimeType:MediaRecorder.isTypeSupported("audio/webm")?"audio/webm":"audio/mp4"});c.current=r,r.ondataavailable=e=>{e.data.size>0&&u.current.push(e.data)},r.onstop=()=>{const e=new Blob(u.current,{type:r.mimeType||"audio/webm"});a(e),d.current&&(d.current.getTracks().forEach(e=>e.stop()),d.current=null)},r.start(100),t(!0),p.current=setInterval(()=>{n(e=>e+1)},1e3)}catch(e){const t=e;let r="Failed to access microphone";"NotAllowedError"===t.name?r="Microphone access denied. Please allow microphone permissions.":"NotFoundError"===t.name&&(r="No microphone found. Please connect a microphone and try again."),l(r)}},[]),h=r.useCallback(()=>{c.current&&e&&(c.current.stop(),t(!1),p.current&&(clearInterval(p.current),p.current=null))},[e]),m=r.useCallback(()=>{h(),a(null),n(0),l(null),u.current=[]},[h]);return r.useEffect(()=>()=>{p.current&&clearInterval(p.current),d.current&&d.current.getTracks().forEach(e=>e.stop())},[]),{isRecording:e,audioBlob:i,duration:s,error:o,start:x,stop:h,reset:m}})(),{progress:ce,isLoading:je,startProgress:fe,completeProgress:ve}=V(),{settings:we,updateSetting:ke}=(()=>{const[e,t]=r.useState({quality:"high",noiseReduction:!0,echoCancellation:!0,autoGain:!0,sensitivity:50});return{settings:e,updateSetting:r.useCallback((e,r)=>{t(t=>({...t,[e]:r}))},[])}})(),{history:Ce,addAnalysis:Se,clearHistory:Re}=(()=>{const[e,t]=r.useState([]);return{history:e,addAnalysis:r.useCallback(e=>{t(t=>[...t.slice(-4),e])},[]),clearHistory:r.useCallback(()=>{t([])},[])}})(),{showSuccess:We,showError:Ae}=j(),{addAnalysisResult:De}=T(),Ie=r.useCallback(e=>`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`,[]),$e=r.useCallback(()=>{if(W)if(u&&C.current)C.current.pause(),x(!1);else{C.current&&C.current.pause();const e=new Audio(URL.createObjectURL(W));C.current=e,e.onended=()=>x(!1),e.onerror=()=>{Ae("Failed to play audio."),x(!1)},e.play().then(()=>x(!0)).catch(()=>{Ae("Failed to play audio."),x(!1)})}},[W,u,Ae]),Te=r.useCallback(()=>{if(!W)return;const e=URL.createObjectURL(W),t=`speech-analysis-${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.webm`,r=document.createElement("a");r.href=e,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(e),We(`Audio saved as ${t} ðŸ“`)},[W,We]),Ee=r.useCallback(()=>{le(),l(null),x(!1),C.current&&(C.current.pause(),C.current=null)},[le]),Pe=r.useCallback((e,t)=>{i(t)},[]);return c.jsxs(k,{sx:{maxWidth:1200,mx:"auto",p:3},children:[c.jsxs(k,{sx:{textAlign:"center",mb:4,opacity:0,animation:"slideInDown 0.8s ease-out forwards","@keyframes slideInDown":{"0%":{opacity:0,transform:"translateY(-30px)"},"100%":{opacity:1,transform:"translateY(0)"}}},children:[c.jsx(g,{variant:"h3",component:"h1",sx:{fontWeight:700,mb:2,background:`linear-gradient(45deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"ðŸŽ¤ Smart Speech Analysis"}),c.jsx(g,{variant:"h6",color:"text.secondary",sx:{mb:3},children:"Record and analyze emotions from speech patterns and vocal characteristics"}),c.jsxs(f,{direction:"row",spacing:2,justifyContent:"center",sx:{mb:3},children:[c.jsx(E,{icon:c.jsx(P,{}),label:`${Ce.length} Analyses`,color:"primary",variant:"outlined"}),c.jsx(E,{icon:c.jsx(w,{}),label:"Real-time AI",color:"secondary",variant:"outlined"}),c.jsx(E,{icon:c.jsx(B,{}),label:"Enhanced UX",color:"success",variant:"outlined"})]})]}),c.jsx(s,{sx:{mb:3},children:c.jsxs(pe,{value:t,onChange:Pe,variant:"fullWidth",children:[c.jsx(ue,{label:"Record & Analyze",value:"record",icon:c.jsx(z,{}),iconPosition:"start"}),c.jsx(ue,{label:"Analysis History",value:"history",icon:c.jsx(M,{}),iconPosition:"start"})]})}),"record"===t&&c.jsxs(xe,{container:!0,spacing:4,children:[c.jsx(xe,{item:!0,xs:12,md:6,children:c.jsx(Z,{children:c.jsxs(he,{sx:{textAlign:"center",p:4},children:[c.jsx(g,{variant:"h5",sx:{fontWeight:600,mb:4},children:"ðŸŽ™ï¸ Audio Recording"}),c.jsx(k,{sx:{mb:4},children:c.jsx(tt,{isRecording:R,onClick:R?oe:I,variant:"contained",disabled:je,children:R?c.jsx(F,{}):c.jsx(z,{})})}),c.jsx(g,{variant:"h3",sx:{fontFamily:"monospace",fontWeight:700,mb:2,color:R?"error.main":"text.primary"},children:Ie(A)}),R&&c.jsxs(k,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:1,mb:3},children:[c.jsx(k,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:"error.main",animation:"blink 1s infinite","@keyframes blink":{"0%, 50%":{opacity:1},"51%, 100%":{opacity:0}}}}),c.jsx(g,{variant:"body2",color:"error.main",sx:{fontWeight:500},children:"Recording in progress..."})]}),(()=>{const e=Array.from({length:20},(e,t)=>c.jsx(et,{isActive:R,height:40*Math.random()+10,sx:{animationDelay:.1*t+"s"}},t));return c.jsx(Ze,{children:e})})(),c.jsxs(f,{spacing:2,sx:{mt:3},children:[c.jsx($,{variant:"outlined",startIcon:c.jsx(L,{}),onClick:Ee,fullWidth:!0,disabled:R||je,children:"Reset Recording"}),c.jsx($,{variant:"outlined",startIcon:c.jsx(N,{}),onClick:()=>p(!d),fullWidth:!0,children:"Audio Settings"})]}),c.jsx(me,{in:d,children:c.jsxs(Z,{interactive:!1,sx:{mt:2,p:2,bgcolor:"background.default"},children:[c.jsx(g,{variant:"subtitle2",sx:{mb:2,fontWeight:"bold"},children:"ðŸ”§ Recording Settings"}),c.jsxs(f,{spacing:2,children:[c.jsxs(k,{children:[c.jsx(g,{variant:"body2",sx:{mb:1},children:"Microphone Sensitivity"}),c.jsx(de,{value:we.sensitivity,onChange:(e,t)=>ke("sensitivity",t),min:0,max:100,step:10,marks:!0,valueLabelDisplay:"auto"})]}),c.jsxs(f,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:[c.jsx(E,{label:"Noise Reduction",color:we.noiseReduction?"primary":"default",onClick:()=>ke("noiseReduction",!we.noiseReduction),clickable:!0}),c.jsx(E,{label:"Echo Cancellation",color:we.echoCancellation?"primary":"default",onClick:()=>ke("echoCancellation",!we.echoCancellation),clickable:!0}),c.jsx(E,{label:"Auto Gain",color:we.autoGain?"primary":"default",onClick:()=>ke("autoGain",!we.autoGain),clickable:!0})]})]})]})}),D&&c.jsx(U,{severity:"error",sx:{mt:2},children:D})]})})}),c.jsx(xe,{item:!0,xs:12,md:6,children:c.jsx(Z,{children:c.jsxs(he,{sx:{p:4},children:[c.jsx(g,{variant:"h5",sx:{fontWeight:600,mb:3},children:"ðŸŽµ Audio Analysis"}),W?c.jsxs(k,{children:[c.jsxs(U,{severity:"success",sx:{mb:3},children:[c.jsx(g,{variant:"subtitle2",sx:{fontWeight:600},children:"Recording Ready for Analysis"}),c.jsxs(g,{variant:"body2",children:["Duration: ",Ie(A)," â€¢ Size: ",(W.size/1024).toFixed(1)," KB"]})]}),ce>0&&c.jsx(n,{in:!0,children:c.jsxs(k,{sx:{mb:3},children:[c.jsx(ge,{variant:"determinate",value:ce,sx:{height:8,borderRadius:4,"& .MuiLinearProgress-bar":{borderRadius:4,background:`linear-gradient(45deg, ${e.palette.primary.main}, ${e.palette.secondary.main})`}}}),c.jsxs(g,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:["Analyzing audio... ",ce.toFixed(0),"%"]})]})}),c.jsxs(xe,{container:!0,spacing:2,sx:{mb:3},children:[c.jsx(xe,{item:!0,xs:4,children:c.jsx(ye,{title:u?"Pause Audio":"Play Audio",children:c.jsx($,{variant:"outlined",startIcon:u?c.jsx(O,{}):c.jsx(Y,{}),onClick:$e,fullWidth:!0,size:"small",children:u?"Pause":"Play"})})}),c.jsx(xe,{item:!0,xs:4,children:c.jsx(ye,{title:"Download Audio",children:c.jsx($,{variant:"outlined",startIcon:c.jsx(G,{}),onClick:Te,fullWidth:!0,size:"small",children:"Save"})})}),c.jsx(xe,{item:!0,xs:4,children:c.jsx(ee,{onClick:async()=>{if(!W)return void Ae("No audio recording available.");const e=fe();try{const e={...await Ue(W),duration:A,timestamp:Date.now()};l(e),Se(e),De("speech",e),We("Audio analyzed successfully! ðŸŽ‰"),b(e),setTimeout(()=>{m(!0)},2e3)}catch(t){Ae("Failed to analyze audio. Please try again.")}finally{ve(e)}},loading:je,loadingText:"Analyzing...",size:"small",fullWidth:!0,children:"Analyze"})})]})]}):c.jsxs(k,{sx:{p:4,textAlign:"center",backgroundColor:"dark"===e.palette.mode?"grey.900":"grey.50",borderRadius:2,border:"2px dashed",borderColor:"divider"},children:[c.jsx(k,{sx:{fontSize:48,color:"text.secondary",mb:2},children:c.jsx(H,{})}),c.jsx(g,{variant:"h6",color:"text.secondary",children:"No recording available"}),c.jsx(g,{variant:"body2",color:"text.secondary",children:"Start recording to analyze speech"})]})]})})})]}),"history"===t&&c.jsx(Z,{children:c.jsxs(he,{children:[c.jsxs(k,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[c.jsx(g,{variant:"h5",sx:{fontWeight:600},children:"ðŸ“š Analysis History"}),c.jsx($,{variant:"outlined",startIcon:c.jsx(K,{}),onClick:Re,disabled:0===Ce.length,color:"error",children:"Clear All"})]}),Ce.length>0?c.jsx(_,{sx:{width:"100%"},children:Ce.reverse().map((e,t)=>{var r;return c.jsxs(X,{sx:{mb:2,border:"1px solid",borderColor:"divider",borderRadius:2,bgcolor:"background.paper"},children:[c.jsx(be,{children:c.jsx(v,{sx:{bgcolor:"primary.main"},children:c.jsx(J,{})})}),c.jsx(q,{primary:c.jsxs(g,{variant:"subtitle1",sx:{fontWeight:600},children:["Analysis #",Ce.length-t]}),secondary:c.jsxs(k,{children:[c.jsx(g,{variant:"body2",color:"text.secondary",children:new Date(e.timestamp).toLocaleString()}),c.jsxs(g,{variant:"body2",color:"text.secondary",children:["Duration: ",Ie(e.duration)," â€¢ Sentiment: ",(null==(r=e.sentiment)?void 0:r.label)||"N/A"]}),e.emotions&&e.emotions.length>0&&c.jsx(k,{sx:{mt:1},children:c.jsx(te,{emotion:e.emotions[0].emotion})})]})})]},t)})}):c.jsxs(k,{sx:{textAlign:"center",py:4},children:[c.jsx(g,{variant:"h6",color:"text.secondary",children:"No analysis history yet"}),c.jsx(g,{variant:"body2",color:"text.secondary",children:"Start recording and analyzing speech to see your history here"})]})]})}),o&&!je&&"record"===t&&c.jsx(n,{in:!0,timeout:800,children:c.jsxs(k,{sx:{mt:4},children:[o.transcription&&c.jsx(Z,{sx:{mb:3},children:c.jsxs(he,{children:[c.jsxs(g,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:["ðŸ“ Transcription",c.jsx(E,{label:"AI Generated",size:"small",color:"primary"})]}),c.jsxs(g,{variant:"body1",sx:{p:2,backgroundColor:"dark"===e.palette.mode?"grey.900":"grey.50",borderRadius:2,fontStyle:"italic",lineHeight:1.6},children:['"',o.transcription,'"']})]})}),o.emotions&&(e=>{if(!e||0===e.length)return null;const t=e.sort((e,t)=>t.confidence-e.confidence).slice(0,5);return c.jsx(Z,{sx:{mb:3},children:c.jsxs(he,{children:[c.jsxs(g,{variant:"h6",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:["ðŸ˜Š Emotion Analysis",c.jsx(ne,{badgeContent:e.length,color:"primary"})]}),c.jsx(f,{spacing:2,children:t.map((e,t)=>c.jsxs(k,{sx:{display:"flex",alignItems:"center",gap:2},children:[c.jsx(te,{emotion:e.emotion}),c.jsx(k,{sx:{flexGrow:1},children:c.jsx(ge,{variant:"determinate",value:100*e.confidence,sx:{height:8,borderRadius:4,"& .MuiLinearProgress-bar":{borderRadius:4,background:se(e.emotion).color}}})}),c.jsxs(g,{variant:"body2",sx:{minWidth:50,textAlign:"right"},children:[(100*e.confidence).toFixed(1),"%"]})]},t))})]})})})(o.emotions),o.sentiment&&(e=>{if(!e)return null;const t="positive"===e.label?"success":"negative"===e.label?"error":"warning";return c.jsx(Z,{sx:{mb:3},children:c.jsxs(he,{children:[c.jsx(g,{variant:"h6",sx:{mb:2},children:"ðŸ’­ Sentiment Analysis"}),c.jsxs(k,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[c.jsx(E,{label:e.label.toUpperCase(),color:t,sx:{fontWeight:"bold"}}),c.jsxs(g,{variant:"body1",children:["Confidence: ",(100*e.confidence).toFixed(1),"%"]})]}),e.scores&&c.jsx(f,{spacing:1,children:Object.entries(e.scores).map(([e,t])=>c.jsxs(k,{sx:{display:"flex",alignItems:"center",gap:2},children:[c.jsxs(g,{variant:"body2",sx:{minWidth:80,textTransform:"capitalize"},children:[e,":"]}),c.jsx(ge,{variant:"determinate",value:100*t,sx:{flexGrow:1,height:6,borderRadius:3}}),c.jsxs(g,{variant:"body2",sx:{minWidth:50,textAlign:"right"},children:[(100*t).toFixed(1),"%"]})]},e))})]})})})(o.sentiment),o.technicalReport&&c.jsx(Z,{sx:{mb:3},children:c.jsxs(he,{children:[c.jsxs(k,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[c.jsxs(g,{variant:"h6",sx:{display:"flex",alignItems:"center",gap:1},children:["ðŸ”¬ Technical Analysis Report",c.jsx(E,{label:"Detailed",size:"small",color:"info"})]}),c.jsx(f,{direction:"row",spacing:1,children:c.jsx(ye,{title:"Download Report",children:c.jsx(S,{size:"small",onClick:()=>{const e=new Blob([o.technicalReport],{type:"text/plain"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=`technical-report-${(new Date).toISOString().slice(0,10)}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t),We("Technical report downloaded! ðŸ“„")},children:c.jsx(G,{})})})})]}),c.jsx(k,{sx:{p:3,backgroundColor:"dark"===e.palette.mode?"grey.900":"grey.50",borderRadius:2,border:"1px solid",borderColor:"divider",position:"relative"},children:c.jsx(g,{variant:"body2",sx:{fontFamily:"monospace",whiteSpace:"pre-line",fontSize:"0.9rem",lineHeight:1.6,color:"text.primary",pr:6},children:o.technicalReport})}),c.jsx(k,{sx:{display:"flex",gap:1,flexWrap:"wrap",mt:2},children:c.jsx($,{size:"small",variant:"outlined",color:"primary",onClick:()=>{const e={timestamp:(new Date).toISOString(),duration:o.duration,content:o.technicalReport,wordCount:o.technicalReport.split(/\s+/).length,characterCount:o.technicalReport.length},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`speech-analysis-report-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r),We("Report exported! ðŸ“Š")},children:"Export JSON"})})]})}),o.genAIInsights&&c.jsx(Z,{sx:{mb:3,border:"1px solid",borderColor:"success.light"},children:c.jsxs(he,{children:[c.jsxs(k,{sx:{display:"flex",alignItems:"center",mb:3},children:[c.jsx(v,{sx:{bgcolor:"success.main",color:"white",mr:2},children:"ðŸ§ "}),c.jsx(g,{variant:"h6",sx:{fontWeight:600,color:"success.main"},children:"AI Wellness Advisor"}),c.jsx(E,{label:"Powered by Llama 3",size:"small",sx:{ml:2,backgroundColor:"success.light",color:"success.main"}})]}),c.jsx(k,{sx:{p:3,backgroundColor:"rgba(46, 125, 50, 0.05)",borderRadius:2,border:"1px solid",borderColor:"success.light"},children:(t=>{if(!t)return"";const r=t.split(/\*\*([^*]+):\*\*/),i=[];for(let a=0;a<r.length;a++)if(a%2==0){if(r[a].trim()){r[a].split("\n").filter(e=>e.trim()).forEach((t,r)=>{const s=t.trim();if(s){const t=s.match(/^(\d+)\.\s*\*\*([^*]+)\*\*:\s*(.+)$/);if(t)i.push(c.jsxs(k,{sx:{mb:2},children:[c.jsxs(g,{variant:"h6",sx:{fontWeight:600,color:"primary.main",mb:1},children:[t[1],". ",t[2]]}),c.jsx(g,{variant:"body1",sx:{color:"text.secondary",lineHeight:1.6},children:t[3]})]},`${a}-${r}`));else if(s.match(/^\d+\./)){const[t,...n]=s.split(/\.\s*/);i.push(c.jsxs(g,{variant:"body1",sx:{mb:1.5,color:"text.primary"},children:[c.jsxs("strong",{style:{color:e.palette.primary.main},children:[t,"."]})," ",n.join(". ")]},`${a}-${r}`))}else i.push(c.jsx(g,{variant:"body1",sx:{mb:1.5,color:"text.primary",lineHeight:1.6},children:s},`${a}-${r}`))}})}}else i.push(c.jsxs(g,{variant:"h5",sx:{fontWeight:700,color:"success.main",mb:2,mt:3},children:["ðŸŒŸ ",r[a]]},a));return c.jsx(k,{children:i})})(o.genAIInsights)})]})})]})}),c.jsxs(re,{ariaLabel:"Quick Actions",sx:{position:"fixed",bottom:24,right:24},icon:c.jsx(ae,{}),direction:"up",children:[c.jsx(ie,{icon:c.jsx(L,{}),tooltipTitle:"Reset All",onClick:()=>{Ee(),l(null),Re()}}),c.jsx(ie,{icon:c.jsx(Q,{}),tooltipTitle:"Share Analysis",onClick:()=>{o&&(navigator.clipboard.writeText(JSON.stringify(o,null,2)),We("Analysis copied to clipboard! ðŸ“‹"))}}),c.jsx(ie,{icon:c.jsx(M,{}),tooltipTitle:"View History",onClick:()=>i("history")})]}),h&&c.jsx(Ve,{analysisResult:y,onClose:()=>{m(!1),b(null)}})]})};export{rt as SpeechAnalysis};
